# è‡ªåŠ¨åŒ–æµ‹è¯•

## å‰ç«¯è‡ªåŠ¨åŒ–æµ‹è¯•

**ï¼ˆè‡ªåŠ¨åŒ–ï¼‰æµ‹è¯•çš„ç›®çš„ï¼š**â‘ é¡¹ç›®ç»è¿‡ä¸æ–­çš„å¼€å‘ï¼Œæœ€ç»ˆè‚¯å®šä¼šè¶‹äºç¨³å®šï¼Œåœ¨**é€‚å½“çš„æ—¶æœºä¸‹**å¼•å…¥è‡ªåŠ¨åŒ–æµ‹è¯•èƒ½åŠæ—©å‘ç°é—®é¢˜ï¼Œ**ä¿è¯äº§å“çš„è´¨é‡**ï¼›â‘¡æœ‰åˆ©äºå†™å‡ºé«˜è´¨é‡çš„ä»£ç ï¼›â‘¢æœ‰åˆ©äºä»£ç çš„æ‰©å±•ï¼›â‘£æœ‰åˆ©äºä»£ç çš„ç»´æŠ¤ã€‚

æµ‹è¯•ä½œä¸ºå®Œæ•´çš„å¼€å‘æµç¨‹ä¸­æœ€åçš„ä¸€ç¯ï¼Œæ˜¯ä¿è¯äº§å“è´¨é‡é‡è¦çš„ä¸€ç¯ã€‚å‰ç«¯æµ‹è¯•ä¸€èˆ¬åœ¨äº§å“å¼€å‘æµç¨‹ä¸­å±äºååçš„ç¯èŠ‚ï¼Œåœ¨æ•´ä¸ªå¼€å‘æ¶æ„ä¸­å±äºè¾ƒé«˜å±‚æ¬¡ï¼Œä¸”å‰ç«¯æµ‹è¯•æ›´åŠ åå‘äºGUIçš„ç‰¹æ€§ï¼Œå› æ­¤å‰ç«¯çš„æµ‹è¯•éš¾åº¦å¾ˆå¤§ã€‚ç¨‹åºå‘˜ä¸æ„¿æ„å†™æµ‹è¯•çš„åŸå› ï¼šâ‘ ä¸ç†Ÿæ‚‰ï¼›â‘¡æµªè´¹æ—¶é—´ï¼›â‘¢çŸ¥è¯†ä¸æˆä½“ç³»ï¼›â‘£å›¢é˜Ÿæ°›å›´ï¼›â‘¤ç¼ºå°‘å®è·µã€‚

### æµ‹è¯•çš„åˆ†ç±»

â‘ æŒ‰æµ‹è¯•æ‰§è¡Œé˜¶æ®µåˆ’åˆ†ï¼šå•å…ƒæµ‹è¯•ï¼ˆå¸¸ç”¨ï¼ŒUnit Testingï¼‰ã€é›†æˆæµ‹è¯•ï¼ˆIntegration Testingï¼Œæ¯”å•å…ƒæµ‹è¯•é¢—ç²’åº¦å¤§ï¼‰ã€ç«¯åˆ°ç«¯æµ‹è¯•ï¼ˆå¸¸ç”¨ï¼ŒE2E Testingï¼Œæ¯”é›†æˆæµ‹è¯•é¢—ç²’åº¦å¤§ï¼‰ã€ç³»ç»Ÿæµ‹è¯•ã€éªŒæ”¶æµ‹è¯•ï¼ˆæ­£å¼éªŒæ”¶æµ‹è¯•ã€Alphaæµ‹è¯•ã€Betaæµ‹è¯•ï¼‰ã€‚

ç«¯åˆ°ç«¯æµ‹è¯•æ¨¡æ‹Ÿç”¨æˆ·çš„è¡Œä¸ºï¼Œä»ç”¨æˆ·å±‚é¢å¯¹æ•´ä¸ªç¨‹åºçš„æµç¨‹å’Œäº¤äº’åšæµ‹è¯•ï¼Œåœ¨ Web åº”ç”¨ç¨‹åºä¸­ï¼Œä¼šå¯åŠ¨æœåŠ¡å™¨ï¼Œæ‰“å¼€æµè§ˆå™¨ï¼Œæ¨¡æ‹Ÿç”¨æˆ·çš„è¡Œä¸ºè¿›è¡Œç‚¹å‡»ã€è¾“å…¥ã€æäº¤ç­‰åŠ¨ä½œï¼Œæ–­è¨€æµè§ˆå™¨ä¸­å‘ç”Ÿäº†ç‰¹å®šçš„äº‹æƒ…æˆ–å¾—åˆ°äº†æœŸå¾…çš„ç»“æœï¼Œä»è€Œçœ‹å‡ºåŠŸèƒ½å¯ä»¥æ­£å¸¸çš„è¿è¡Œã€‚å•å…ƒæµ‹è¯•æ˜¯æ ¹æ®ä»£ç å•å…ƒçš„å…¬å…± API è¿è¡Œå®ƒä»¬ï¼Œæ˜¯é’ˆå¯¹åŠŸèƒ½æ¨¡å—çš„ï¼Œéœ€è¦åˆ›å»ºä¸€ä¸ªç±»çš„å®ä¾‹ï¼Œä½¿ç”¨ç‰¹å®šçš„è¾“å…¥è°ƒç”¨å®ƒçš„æ–¹æ³•ï¼Œæ–­è¨€è¢«è°ƒç”¨çš„æ–¹æ³•è¾¾åˆ°äº†é¢„æœŸçš„æ•ˆæœã€‚

åœ¨å¤šæµè§ˆå™¨çš„è‡ªåŠ¨åŒ–æµ‹è¯•ï¼Œå¤šåŠæ˜¯è¿›è¡Œç«¯åˆ°ç«¯çš„æµ‹è¯•å·¥ä½œï¼Œå…¶å®ƒä¸€å°éƒ¨åˆ†æ˜¯å¤§ç²’åº¦çš„å•å…ƒæµ‹è¯•ã€‚è¿™ä¸¤ç§æµ‹è¯•çš„å®è·µï¼Œæœ‰æ—¶å€™åŒºåˆ†åº¦å¹¶ä¸å¤§ï¼Œæœ‰æ—¶å€™ä¹Ÿæ˜¯æ··åˆèµ·æ¥çš„ï¼Œå¯èƒ½æ— æ³•æ˜æ˜¾åœ°åŒºåˆ†å“ªäº›æ˜¯ç«¯å¯¹ç«¯æµ‹è¯•å“ªäº›æ˜¯å•å…ƒæµ‹è¯•ã€‚

æŒ‰ç…§è½¯ä»¶å·¥ç¨‹è‡ªåº•è€Œä¸Šçš„æ¦‚å¿µï¼Œå‰ç«¯æµ‹è¯•ä¸€èˆ¬åˆ†ä¸ºå•å…ƒæµ‹è¯•ã€é›†æˆæµ‹è¯•å’Œç«¯åˆ°ç«¯æµ‹è¯•ï¼Œä»åº•å‘ä¸Šæµ‹è¯•çš„å¤æ‚åº¦å°†ä¸æ–­æé«˜ï¼Œå¦ä¸€æ–¹é¢æµ‹è¯•çš„æ”¶ç›Šåè€Œä¸æ–­é™ä½çš„ã€‚

<img src="README.assets/16415de723a8d411.png" alt="img" style="zoom:67%;" />

â‘¡æŒ‰æµ‹è¯•æŠ€æœ¯åˆ’åˆ†ï¼šç™½ç›’æµ‹è¯•ï¼ˆçŸ¥é“ç›’å­é‡Œçš„æ‰€æœ‰åŠŸèƒ½ä»£ç å’Œé€»è¾‘ï¼Œå†è¿›è¡Œæµ‹è¯•ï¼‰ã€é»‘ç›’æµ‹è¯•ï¼ˆå¦‚ç«¯åˆ°ç«¯æµ‹è¯•ï¼Œä¸çŸ¥é“ç›’å­é‡Œçš„ä»»ä½•ä¸œè¥¿ï¼Œä½†é€šè¿‡ç»™è¾“å…¥èƒ½å¾—åˆ°è¾“å‡ºï¼Œä»è€Œåœ¨ç›’å­çš„å¤–éƒ¨å¯¹ç¨‹åºè¿›è¡Œæµ‹è¯•ï¼‰ã€ç°ç›’æµ‹è¯•ã€‚

â‘¢æŒ‰è¢«æµ‹è¯•å¯¹è±¡æ˜¯å¦è¿è¡Œåˆ’åˆ†ï¼šåŠ¨æ€æµ‹è¯•ã€é™æ€æµ‹è¯•ï¼ˆæ–‡æ¡£æ£€æŸ¥ã€ä»£ç èµ°æŸ¥ã€ç•Œé¢æ£€æŸ¥ï¼‰ã€‚

â‘£æŒ‰ä¸åŒçš„æµ‹è¯•æ‰‹æ®µåˆ’åˆ†ï¼šæ‰‹å·¥æµ‹è¯•ã€è‡ªåŠ¨åŒ–æµ‹è¯•ã€‚

â‘¤æŒ‰æµ‹è¯•åŒ…å«çš„å†…å®¹åˆ’åˆ†ï¼šåŠŸèƒ½æµ‹è¯•ã€ç•Œé¢æµ‹è¯•ã€å®‰å…¨æµ‹è¯•ã€å…¼å®¹æ€§æµ‹è¯•ã€æ˜“ç”¨æ€§æµ‹è¯•ã€æ€§èƒ½æµ‹è¯•ã€å‹åŠ›æµ‹è¯•ã€è´Ÿè½½æµ‹è¯•ã€æ¢å¤æµ‹è¯•ã€‚

â‘¥å…¶ä»–æµ‹è¯•ï¼šå†’çƒŸæµ‹è¯•ï¼ˆè¯•è¿è¡Œç¨‹åºï¼Œçœ‹çœ‹ä¼šä¸ä¼šå®æ‰ï¼‰ã€å›å½’æµ‹è¯•ã€æ¢ç´¢æ€§æµ‹è¯•/è‡ªç”±æµ‹è¯•ï¼ˆæµ‹è¯•æ€ç»´ï¼‰ã€‚

### æµ‹è¯•çš„å·¥å…·

#### æµ‹è¯•å·¥å…·çš„é€‰æ‹©

æµ‹è¯•æ¡†æ¶ï¼Œå°±æ˜¯è¿è¡Œæµ‹è¯•çš„å·¥å…·ï¼Œå…¶å¯ä»¥ä¸ºJavaScriptåº”ç”¨æ·»åŠ æµ‹è¯•ï¼Œä»è€Œä¿è¯ä»£ç çš„è´¨é‡ã€‚æµ‹è¯•æ¡†æ¶åŸºæœ¬ä¸Šéƒ½åšçš„äº‹æƒ…ï¼šæè¿°è¦æµ‹è¯•çš„ä¸œè¥¿ï¼ˆåŠŸèƒ½æˆ–æ¨¡å—æˆ–éœ€è¦åšçš„æ“ä½œï¼‰ï¼›å¯¹å…¶è¿›è¡Œæµ‹è¯•ï¼›åˆ¤æ–­æ˜¯å¦ç¬¦åˆé¢„æœŸã€‚

å‰ç«¯çš„æµ‹è¯•å·¥ä½œä¹Ÿéœ€è¦é€‰æ‹©ä¸€å¥—æŠ€æœ¯æ ˆï¼Œ**è€ƒè™‘ç‚¹ï¼š**

â‘ æµ‹è¯•æ¡†æ¶æ˜¯å¦æœ‰ç®€æ˜çš„è¯­æ³•ä¸æ–‡æ¡£ï¼ˆå•å…ƒæµ‹è¯•å·¥å…·æœ‰Mochaã€Jestã€AVAã€Jasmineã€Karma(ä¸å®Œå…¨æ˜¯ä¸€ä¸ªå•å…ƒæµ‹è¯•çš„å·¥å…·ï¼Œæ›´åƒæ˜¯ä¸€ä¸ªè¿è¡Œç¯å¢ƒ)ï¼›E2Eæµ‹è¯•å·¥å…·æœ‰Nightmareï¼‰

â‘¡æ–­è¨€ï¼ˆAssertionsï¼‰ï¼šç”¨äºåˆ¤æ–­ç»“æœæ˜¯å¦ç¬¦åˆé¢„æœŸï¼Œä½†æœ‰äº›æ¡†æ¶ï¼ˆå¦‚Mochaï¼‰éœ€è¦å•ç‹¬çš„æ–­è¨€åº“ï¼Œè€ŒShould.jsã€chaiã€expect.jsç­‰æ–­è¨€åº“æä¾›äº†å¾ˆå¤šè¯­ä¹‰åŒ–çš„æ–¹æ³•æ¥å¯¹å€¼åšå„ç§å„æ ·çš„åˆ¤æ–­ã€‚å½“ç„¶ä¹Ÿå¯ä»¥ä¸ç”¨æ–­è¨€åº“ï¼ŒNode.jsä¸­ä¹Ÿå¯ä»¥ç›´æ¥ä½¿ç”¨åŸç”Ÿassertåº“ã€‚

â‘¢æ˜¯å¦é€‚åˆ TDD / BDDï¼ˆ æµ‹è¯•é©±åŠ¨å‹ / è¡Œä¸ºé©±åŠ¨å‹ çš„æµ‹è¯•é£æ ¼ï¼‰ï¼šTDDï¼ˆTesting Driven Developementï¼Œæµ‹è¯•é©±åŠ¨å¼€å‘ï¼‰å’ŒBDDï¼ˆBebavior Driven Developementï¼Œè¡Œä¸ºé©±åŠ¨å¼€å‘ï¼‰å‡æœ‰å„è‡ªçš„é€‚ç”¨åœºæ™¯ã€‚æ³¨æ„ï¼šæœ¬æ–‡TDDä¸“æŒ‡ UTDDï¼ˆUnit Test Driven Developmentï¼Œå•å…ƒæµ‹è¯•é©±åŠ¨å¼€å‘ï¼Œ[æµ‹è¯•é©±åŠ¨å¼€å‘ï¼ˆTDDï¼‰æ€»ç»“â€”â€”åŸç†ç¯‡](https://juejin.im/post/5c3e73876fb9a049d37f5db1)ï¼‰ã€‚

TDDçš„ç‰¹ç‚¹ï¼ˆåå‘äºå¿«é€Ÿå¼€å‘è¿­ä»£å’Œæµ‹è¯•åŠŸèƒ½æ¨¡å—çš„åœºæ™¯ï¼Œä»¥å¿«é€Ÿå®Œæˆå¼€å‘ä¸ºç›®çš„ï¼Œç›¸å¯¹è€Œè¨€æ›´åŠ é«˜æ•ˆï¼Œä¸”èƒ½ä¿è¯é¡¹ç›®å‰æœŸå¥å£®æ€§ï¼Œé™ä½é¡¹ç›®åæœŸç»´æŠ¤æˆæœ¬ï¼‰ï¼š
éœ€æ±‚åˆ†æï¼Œå¿«é€Ÿç¼–å†™å¯¹åº”çš„è¾“å…¥è¾“å‡ºæµ‹è¯•è„šæœ¬ï¼›
**ä»…åœ¨è‡ªåŠ¨æµ‹è¯•å¤±è´¥æ—¶æ‰ç¼–å†™æ–°ä»£ç **ï¼›
é‡æ„å»é™¤ä¸å¿…è¦çš„ä¾èµ–å…³ç³»ï¼Œç„¶åé‡å¤æµ‹è¯•ï¼Œæœ€ç»ˆè®©ç¨‹åºç¬¦åˆæ‰€æœ‰è¦æ±‚ã€‚

TDD çš„ç›®æ ‡ï¼šKent Beck åœ¨ä»–çš„è‘—ä½œã€ŠTest-Driven Developmentã€‹ä¸€ä¹¦ä¸­æåˆ°ï¼š**ä»£ç ç®€æ´å¯ç”¨**è¿™å¥è¨€ç®€æ„èµ…çš„è¯ï¼Œæ­£æ˜¯ TDD æ‰€è¿½æ±‚çš„ç›®æ ‡ã€‚**å¯¹äºå¦‚ä½•ä¿è¯â€œä»£ç ç®€æ´å¯ç”¨â€å¯ä»¥ä½¿ç”¨åˆ†è€Œæ²»ä¹‹çš„æ–¹æ³•ï¼Œå…ˆè¾¾åˆ°â€œå¯ç”¨â€ç›®æ ‡ï¼Œå†è¿½æ±‚â€œç®€æ´â€ç›®æ ‡ã€‚**
å¯ç”¨ï¼šä¿è¯ä»£ç é€šè¿‡è‡ªåŠ¨åŒ–æµ‹è¯•ã€‚
ä»£ç ç®€æ´ï¼šåœ¨ä¸åŒé˜¶æ®µå¯¹ç®€æ´çš„ç†è§£ä¸ä¸€æ ·ï¼Œä¸è¿‡éµå¾ªçš„åŸåˆ™å·®ä¸å¤šï¼ˆå¦‚ OOD çš„ SOLID åŸåˆ™ï¼ŒKent Beck çš„ Simple Design åŸåˆ™ç­‰ï¼‰ã€‚

BDDçš„ç‰¹ç‚¹ï¼ˆåå‘äºç³»ç»ŸåŠŸèƒ½å’Œä¸šåŠ¡é€»è¾‘çš„è‡ªåŠ¨åŒ–æµ‹è¯•çš„è®¾è®¡ï¼Œä»ç³»ç»Ÿçš„å±‚é¢è¿›è¡Œå…¨å±€ç»Ÿç­¹ï¼‰ï¼š
ä»ä¸šåŠ¡é€»è¾‘çš„è§’åº¦å®šä¹‰å…·ä½“çš„è¾“å…¥ä¸é¢„æœŸè¾“å‡ºï¼Œä»¥åŠå¯è¡¡é‡çš„ç›®æ ‡ï¼›
å°½å¯èƒ½è¦†ç›–æ‰€æœ‰çš„æµ‹è¯•ç”¨ä¾‹æƒ…å†µï¼›
æè¿°ä¸€ç³»åˆ—å¯æ‰§è¡Œçš„è¡Œä¸ºï¼Œæ ¹æ®ä¸šåŠ¡çš„åˆ†ææ¥å®šä¹‰é¢„æœŸè¾“å‡ºï¼ˆå¦‚expect, should, assertï¼‰ï¼›
è®¾å®šå…³é”®çš„æµ‹è¯•é€šè¿‡èŠ‚ç‚¹è¾“å‡ºæç¤ºï¼Œä¾¿äºæµ‹è¯•äººå‘˜ç†è§£ï¼›
æœ€å¤§ç¨‹åº¦çš„äº¤ä»˜å‡ºç¬¦åˆç”¨æˆ·æœŸæœ›çš„äº§å“ï¼Œé¿å…è¾“å‡ºä¸ä¸€è‡´å¸¦æ¥çš„é—®é¢˜ã€‚

â‘£æ”¯æŒå¼‚æ­¥æµ‹è¯•ï¼šæœ‰äº›æ¡†æ¶å¯¹å¼‚æ­¥æµ‹è¯•æ”¯æŒè‰¯å¥½ã€‚

â‘¤ä½¿ç”¨çš„è¯­è¨€ï¼šå¤§éƒ¨åˆ†æµ‹è¯•æ¡†æ¶ä½¿ç”¨ jsï¼Œéƒ¨åˆ†æµ‹è¯•æ¡†æ¶ä½¿ç”¨tsã€‚

â‘¥ç”¨äºç‰¹å®šç›®çš„ï¼šæ¯ä¸ªæ¡†æ¶å¯èƒ½ä¼šæ“…é•¿å¤„ç†ä¸åŒçš„é—®é¢˜ã€‚

â‘¦ç¤¾åŒºæ˜¯å¦æ´»è·ƒã€‚

#### æµ‹è¯•å·¥å…·çš„åŠŸèƒ½

æœ‰äº›æµ‹è¯•æ¡†æ¶åªæä¾›äº†ä¸€ç§åŠŸèƒ½ï¼Œæœ‰äº›åˆ™æä¾›äº†ä¸€ç§ç»„åˆåŠŸèƒ½ï¼ˆä¸ºäº†å®ç°æœ€çµæ´»çš„é›†åˆåŠŸèƒ½ï¼Œé€šå¸¸ä½¿ç”¨å¤šç§å·¥å…·çš„ç»„åˆï¼‰ã€‚

â‘ æä¾›UIç•Œé¢æˆ–CLIå·¥å…·ï¼ˆ[Karma](https://karma-runner.github.io/)ï¼Œ[Jasmine](http://jasmine.github.io/)ï¼Œ[Jest](https://facebook.github.io/jest/)ï¼Œ[TestCafe](https://github.com/DevExpress/testcafe)ï¼Œ[Cypress](https://www.cypress.io/)ï¼‰ï¼š**CLIå·¥å…·**ä¼šç»™å‡ºä¸€ç³»åˆ—æµ‹è¯•ï¼Œä»¥åŠè¿è¡Œè¿™äº›æµ‹è¯•æ‰€éœ€çš„å„ç§é…ç½®å’Œè„šæ‰‹æ¶ï¼ˆè¿è¡Œä»€ä¹ˆæµè§ˆå™¨ï¼Œä½¿ç”¨ä»€ä¹ˆbabelæ’ä»¶ï¼Œå¦‚ä½•æ ¼å¼åŒ–è¾“å‡ºç­‰ï¼‰ã€‚

â‘¡æä¾›æµ‹è¯•æ¡†æ¶ï¼Œå½¢æˆæ–‡ä»¶ç›®å½•ï¼ˆ[Mocha](https://mochajs.org/), [Jasmine](http://jasmine.github.io/), [Jest](https://facebook.github.io/jest/), [Cucumber](https://github.com/cucumber/cucumber-js), [TestCafe](https://github.com/DevExpress/testcafe), [Cypress](https://www.cypress.io/)ï¼‰ã€‚

â‘¢æä¾›æ–­è¨€ï¼ˆ[Chai](http://chaijs.com/)ï¼Œ[Jasmine](http://jasmine.github.io/)ï¼Œ[Jest](https://facebook.github.io/jest/)ï¼Œ[Unexpected](http://unexpected.js.org/)ï¼Œ[TestCafe](https://github.com/DevExpress/testcafe)ï¼Œ[Cypress](https://www.cypress.io/)ï¼‰ï¼š**æ–­è¨€å‡½æ•°**æ£€æŸ¥æµ‹è¯•è¿”å›çš„ç»“æœæ˜¯å¦ç¬¦åˆé¢„æœŸã€‚

â‘£ç”Ÿæˆå’Œå±•ç¤ºæµ‹è¯•ç»“æœï¼ˆ[Mocha](https://mochajs.org/)ï¼Œ[Jasmine](http://jasmine.github.io/)ï¼Œ[Jest](https://facebook.github.io/jest/)ï¼Œ[Karma](https://karma-runner.github.io/)ï¼Œ[TestCafe](https://github.com/DevExpress/testcafe)ï¼Œ[Cypress](https://www.cypress.io/)ï¼‰ï¼šæ³¨æ„è¿™é‡Œä¸åŒäºæµ‹è¯•çš„è¦†ç›–ç‡ã€‚

â‘¤å¿«ç…§æµ‹è¯•ï¼ˆ[Jest](https://facebook.github.io/jest/)ï¼Œ[Ava](https://github.com/avajs/ava)ï¼‰ï¼šå¿«ç…§æµ‹è¯•ï¼ˆsnapshot testingï¼‰ï¼Œæµ‹è¯• UI æˆ–æ•°æ®ç»“æ„æ˜¯å¦å’Œä¹‹å‰å®Œå…¨ä¸€è‡´ï¼Œé€šå¸¸ UI æµ‹è¯•ä¸åœ¨å•å…ƒæµ‹è¯•ä¸­ã€‚

â‘¥æä¾›ä»¿çœŸï¼ˆ[Sinon](http://sinonjs.org/)ï¼Œ[Jasmine](http://jasmine.github.io/)ï¼Œ[enzyme](http://airbnb.io/enzyme/docs/api/)ï¼Œ[Jest](https://facebook.github.io/jest/)ï¼Œ[testdouble](https://testdouble.com/)ï¼‰ï¼šä»¿çœŸï¼ˆmocks, spies, and stubsï¼‰ï¼Œè·å–æ–¹æ³•çš„è°ƒç”¨ä¿¡æ¯ã€æ¨¡æ‹Ÿæ–¹æ³•ã€æ¨¡å—ã€æœåŠ¡å™¨ã€‚

â‘¦ç”Ÿæˆæµ‹è¯•è¦†ç›–ç‡æŠ¥å‘Šï¼ˆ[Istanbul](https://gotwarlost.github.io/istanbul/), [Jest](https://facebook.github.io/jest/), [Blanket](http://blanketjs.org/)ï¼‰ã€‚

â‘§æä¾›ç±»æµè§ˆå™¨ç¯å¢ƒï¼ˆ[Nightwatch](http://nightwatchjs.org/), [Nightmare](http://www.nightmarejs.org/), [Phantom](http://phantomjs.org/)**,** [Puppeteer](https://github.com/GoogleChrome/puppeteer), [TestCafe](https://github.com/DevExpress/testcafe), [Cypress](https://www.cypress.io/)ï¼‰ã€‚

â‘¨å¯è§†åŒ–å›å½’å·¥å…·ï¼ˆ[Applitools](https://applitools.com/), [Percy](https://percy.io/), [Wraith](http://bbc-news.github.io/wraith/), [WebdriverCSS](https://github.com/webdriverio-boneyard/webdrivercss)ï¼‰ã€‚

#### å•å…ƒæµ‹è¯•ç±»å·¥å…·

å•å…ƒæµ‹è¯•æµç¨‹ï¼šå¼•å…¥å¾…æµ‹è¯•çš„æ–‡ä»¶ã€å®šä¹‰æµ‹è¯•ã€æ‰§è¡Œå¼•å…¥æµ‹è¯•çš„æ–¹æ³•ã€åšå‡ºæ–­è¨€ã€‚

â‘ **Karma**ï¼šä¸€ä¸ªRunnerï¼ˆå³è¿è¡Œç¯å¢ƒï¼‰ã€‚`A test runner is the library or tool that picks up an assembly (or a source code directory) that contains unit tests, and a bunch of settings, and then executes them and writes the test results to the console or log files.   there are many runners for different languages. See Nunit and MSTest for C#, or Junit for Java.`

karma è®¾è®¡ç›®æ ‡ä¸»è¦æœ‰å››ç‚¹ï¼šé«˜æ•ˆã€æ‰©å±•æ€§ã€è¿è¡Œåœ¨çœŸå®è®¾å¤‡ã€æ— ç¼çš„ä½¿ç”¨æµç¨‹ã€‚karma æ˜¯ä¸€ä¸ªå…¸å‹çš„ C/S ç¨‹åºï¼ˆåŒ…å«client å’Œ serverï¼‰ï¼Œé€šè®¯æ–¹å¼åŸºäºHttpï¼Œé€šå¸¸æƒ…å†µä¸‹ï¼Œå®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯åŸºæœ¬éƒ½è¿è¡Œåœ¨å¼€å‘è€…æœ¬åœ°æœºå™¨ä¸Šã€‚ä¸€ä¸ªæœåŠ¡ç«¯å®ä¾‹å¯¹åº”ä¸€ä¸ªé¡¹ç›®ï¼Œå‡å¦‚æƒ³åŒæ—¶è¿è¡Œå¤šä¸ªé¡¹ç›®ï¼Œå¾—åŒæ—¶å¼€å¯å¤šä¸ªæœåŠ¡ç«¯å®ä¾‹ã€‚

Karma çš„**ä¼˜ç‚¹**æ˜¯èƒ½é€šè¿‡æ’ä»¶å’Œé…ç½®çš„æ–¹å¼é›†æˆå¤§éƒ¨åˆ†çš„ä¸»æµçš„æµ‹è¯•æ¡†æ¶å’Œå‰ç«¯åº“ï¼Œèƒ½æ–¹ä¾¿çš„ä¸€æ¬¡åœ¨å¤šæµè§ˆå™¨ç¯å¢ƒæ‰§è¡Œæµ‹è¯•ç”¨ä¾‹ï¼Œå¹¶é›†æˆäº†æµ‹è¯•è¦†ç›–ç‡ç”ŸæˆåŠŸèƒ½ï¼Œç”Ÿæˆé¡µé¢å½¢å¼è¦†ç›–ç‡æŠ¥å‘Šå¹¶èƒ½å¯¼å‡ºä¸åŒå½¢å¼çš„è¦†ç›–ç‡æŠ¥å‘Šæ•°æ®ï¼›**ç¼ºç‚¹**æ˜¯å¯¹æµ‹è¯•é¡µé¢ç¯å¢ƒçš„æ­å»ºå’Œèµ„æºæ–‡ä»¶çš„åŠ è½½ä¸æ˜¯å¸¸è§çš„å½¢å¼ï¼Œæœ€å¼€å§‹æ­å»ºç¯å¢ƒæ—¶ä¼šæœ‰å¾ˆå¤šè·Ÿé¢„æœŸä¸ä¸€è‡´çš„æƒ…å†µï¼Œé…ç½®ä¸ç›´è§‚ã€‚

â‘¡**Jasmine**ï¼šJasmine å¸¦æœ‰ assertionsï¼ˆæ–­è¨€ï¼‰ã€spiesï¼ˆç”¨æ¥æ¨¡æ‹Ÿå‡½æ•°çš„æ‰§è¡Œç¯å¢ƒï¼‰å’Œ mocksï¼ˆmockå·¥å…·ï¼‰ã€‚Jasmine åˆå§‹åŒ–è®¾ç½®ç®€å•ï¼Œå¦‚æœéœ€è¦ä¸€äº›å•å…ƒåŠŸèƒ½æ—¶ï¼Œå¯ä»¥åŠ ä¸€äº›åº“è¿›æ¥ã€‚

â‘¢**Mocha**ï¼šMocha æ˜¯ä¸€ä¸ªçµæ´»çš„åº“ï¼Œæä¾›ç»™å¼€å‘è€…çš„åªæœ‰ä¸€ä¸ªåŸºç¡€æµ‹è¯•ç»“æ„ï¼Œå…¶å®ƒåŠŸèƒ½æ€§çš„åŠŸèƒ½ï¼ˆå¦‚ assertionsï¼Œ spieså’Œmocksï¼‰ï¼Œéœ€è¦å¼•ç”¨æ·»åŠ å…¶å®ƒåº“/æ’ä»¶æ¥å®Œæˆã€‚

â‘£**Jest**ï¼šåœ¨Jasmineçš„åŸºç¡€ä¹‹ä¸Šè¿›è¡Œäº†ä¸€äº›æ”¹è¿›ï¼ŒJest å¾—åˆ°äº†å¾ˆå¥½çš„æ”¯æŒï¼Œè¢« Facebook å’Œå„ç§ React åº”ç”¨æ¨èå’Œä½¿ç”¨ï¼Œå¼€å‘äººå‘˜ä¸»è¦æ˜¯ç”¨ Jest å»æµ‹è¯• React åº”ç”¨ï¼ŒJestå¯ä»¥å¾ˆå®¹æ˜“åœ°é›†æˆåˆ°å…¶å®ƒåº”ç”¨ç¨‹åºä¸­ã€‚Jestä¹Ÿæ˜¯ä¸€ä¸ªåœ¨å¹³è¡Œæµ‹è¯•æŠ¥å‘Šä¸­éå¸¸å¿«é€Ÿçš„æµ‹è¯•åº“ã€‚

å¯¹äºå°å‹é¡¹ç›®æ¥è¯´ä½ å¯èƒ½åœ¨å¼€å§‹çš„æ—¶å€™ä¸ç”¨è¿‡å¤šæ‹…å¿ƒï¼Œè€Œæ€§èƒ½çš„æé«˜ï¼Œå¯¹äºå¸Œæœ›å…¨å¤©æŒç»­éƒ¨ç½²çš„å¤§å‹åº”ç”¨ app æ¥è¯´æ˜¯éå¸¸ä¹‹å¥½çš„ã€‚

â‘¤**AVA**ï¼šå…¶ä¼˜åŠ¿æ˜¯åˆ©ç”¨äº†JavaScriptçš„å¼‚æ­¥ç‰¹æ€§ï¼ˆä¼˜åŒ–äº†åœ¨éƒ¨ç½²çš„ç­‰å¾…æ—¶é—´ï¼‰å’Œå¹¶å‘è¿è¡Œæµ‹è¯•ï¼Œä¿ç•™äº†ç®€å•çš„ API æ¥æä¾›éœ€è¦çš„åŠŸèƒ½ï¼Œä½†æ˜¯æ­é… mocking æ¥ä½¿ç”¨åˆ™è¦å®‰è£…ä¸€ä¸ªå•ç‹¬çš„åº“ã€‚

npm trendsï¼š[ç‚¹å‡»é“¾æ¥](https://www.npmtrends.com/mocha-vs-jest-vs-ava-vs-jasmine-core)ã€‚

<img src="README.assets/image-20190706101634263.png" alt="image-20190706101634263" style="zoom: 67%;" />

#### E2Eæµ‹è¯•ç±»å·¥å…·

ç«¯åˆ°ç«¯æµ‹è¯•ä¸»è¦åšçš„æ˜¯é»‘ç›’æµ‹è¯•ï¼Œæ›´å¤šçš„æ˜¯ä»ç”¨æˆ·çš„è§’åº¦æ¥å‡ºå‘å¹¶è¿›è¡Œçš„ä¸€äº›æµ‹è¯•ï¼Œåœ¨ç¨‹åºå¤–éƒ¨ä¸äº†è§£ç¨‹åºå†…éƒ¨çš„é€»è¾‘èµ°å‘çš„æ—¶å€™ï¼Œå»å¯¹æµè§ˆå™¨è¿›è¡Œæ“ä½œï¼Œæ¥äº†è§£ç¨‹åºçš„æ•´ä¸ªäº¤äº’ï¼ˆåŒ…æ‹¬é€»è¾‘æµç¨‹ï¼‰ï¼Œæ£€éªŒæ˜¯å¦æŒ‰ç…§æœŸæœ›é‚£æ ·æ¥ç»™å‡ºç»“æœã€‚

npm trendsï¼š[ç‚¹å‡»é“¾æ¥](https://www.npmtrends.com/cypress-vs-nightmare-vs-nightwatch-vs-testcafe-vs-webdriverio)ã€‚

<img src="README.assets/image-20190706100636750.png" alt="image-20190706100636750" style="zoom:67%;" />

### æœ€ä½³å®è·µ

æµ‹è¯•ä¸ä»£è¡¨ä¸€ä¸Šæ¥å°±è¦å†™å‡º100%åœºæ™¯è¦†ç›–çš„æµ‹è¯•ç”¨ä¾‹ï¼Œ**æœ€ä½³çš„å®è·µæ˜¯åŸºäºæŠ•å…¥äº§å‡ºæ¯”æ¥åšæµ‹è¯•**ã€‚ç”±äºç»´æŠ¤æµ‹è¯•ç”¨ä¾‹ä¹Ÿæ˜¯ä¸€å¤§ç¬”å¼€é”€ï¼ˆæ¯•ç«Ÿæ²¡æœ‰å¤šå°‘æµ‹è¯•ä¼šä¸“é—¨å¸®å‰ç«¯å†™ä¸šåŠ¡æµ‹è¯•ç”¨ä¾‹ï¼Œè€Œå‰ç«¯ä½¿ç”¨çš„æµç¨‹è‡ªåŠ¨åŒ–å·¥å…·æ›´æ˜¯æ²¡æœ‰æµ‹è¯•å‚ä¸äº†ï¼‰ï¼Œæ‰€ä»¥å¯¹äºåƒåŸºç¡€ç»„ä»¶ã€åŸºç¡€æ¨¡å‹ä¹‹ç±»çš„ä¸å¸¸å˜æ›´ä¸”å¤ç”¨è¾ƒå¤šçš„éƒ¨åˆ†ï¼Œå¯ä»¥ä¼˜å…ˆè€ƒè™‘å»å†™æµ‹è¯•ç”¨ä¾‹æ¥ä¿è¯è´¨é‡ï¼Œè¾¾åˆ°å…ˆå†™å°‘é‡çš„æµ‹è¯•ç”¨ä¾‹è¦†ç›–åˆ°80%+çš„åœºæ™¯ï¼Œä¿è¯è¦†ç›–ä¸»è¦çš„ä½¿ç”¨æµç¨‹ã€‚è€Œä¸€äº›æç«¯åœºæ™¯å‡ºç°çš„bugå¯ä»¥åœ¨è¿­ä»£ä¸­å½¢æˆæµ‹è¯•ç”¨ä¾‹æ²‰æ·€ï¼Œåœºæ™¯è¦†ç›–ä¹Ÿå°†é€æ¸è¶‹è¿‘100%ï¼Œä½†å¯¹äºè¿­ä»£è¾ƒå¿«çš„ä¸šåŠ¡é€»è¾‘ä»¥åŠç”Ÿå­˜æ—¶é—´ä¸é•¿çš„æ´»åŠ¨é¡µé¢ä¹‹ç±»çš„å°±åˆ«èŠ±æ—¶é—´å†™æµ‹è¯•ç”¨ä¾‹äº†ï¼Œå› ä¸ºç»´æŠ¤æµ‹è¯•ç”¨ä¾‹çš„æ—¶é—´å¤ªå¤šï¼Œæˆæœ¬å¤ªé«˜ã€‚

å¯¹äºå¤§å‹é¡¹ç›®ï¼Œå¯ä»¥ä½¿ç”¨Jestå¿«é€Ÿå½¢æˆé…ç½®ï¼ˆåšæ¯”è¾ƒå°‘çš„é…ç½®ï¼‰å¹¶ä¸”å¼€å§‹å•å…ƒæµ‹è¯•ï¼›éœ€è¦æµ‹è¯•å¿«ç…§çš„ï¼Œåˆ™å¯ä»¥é€‰æ‹©Jestæˆ–Avaï¼›å¯¹äºé…ç½®æ€§è¦æ±‚é«˜ï¼ˆé…ç½®è¦æ±‚å¤šï¼‰ï¼Œå¯¹æµ‹è¯•æ¡†æ¶æ€§èƒ½è¦æ±‚æ¯”è¾ƒé«˜çš„ï¼Œå¯ä»¥é€‰æ‹©Mochaï¼›å¯¹æ¨¡æ‹Ÿè¿˜åŸæµè§ˆå™¨ä¸šåŠ¡æ“ä½œæœ‰å¾ˆå¤§çš„éœ€æ±‚çš„ï¼Œå¯ä»¥é€‰æ‹©Nightmareã€‚å¦å¤–ï¼Œå¯ä»¥é€šè¿‡é…åˆCIå·¥å…·å®Œæˆè‡ªåŠ¨åŒ–æµ‹è¯•ã€æµ‹è¯•è¦†ç›–ç‡ã€æµ‹è¯•ç»“æœæ¨é€ã€‚



## Mocha

[`Mocha`](https://mochajs.org/)ï¼ˆå‘éŸ³"æ‘©å¡"ï¼‰è¯ç”Ÿäº2011å¹´ï¼Œæ˜¯ç°åœ¨æœ€æµè¡Œçš„JavaScriptæµ‹è¯•æ¡†æ¶ä¹‹ä¸€ï¼Œåœ¨æµè§ˆå™¨å’ŒNodeç¯å¢ƒä¸­éƒ½å¯ä»¥ä½¿ç”¨ï¼Œå®ƒçš„é…ç½®æ¯”è¾ƒç®€å•ï¼Œä½†è¦æ³¨æ„Mochaä¸æä¾›æ–­è¨€åº“ï¼Œè€Œä¸”æ˜¯åœ¨ä¸€ä¸ªè¿›ç¨‹è¿è¡Œæ‰€æœ‰çš„æµ‹è¯•çš„ã€‚

### å®‰è£…

å…¨å±€å®‰è£…Mochaï¼š`npm install -g mocha`ã€‚ä½¿ç”¨æ–¹å¼ï¼šç›´æ¥ä½¿ç”¨mochaï¼Œä¹Ÿå¯ä»¥åœ¨package.jsonä¸­çš„`scripts`èŠ‚ç‚¹ä¸‹åŠ å…¥`"test": "mocha"`è„šæœ¬æ¥è¿è¡Œã€‚

é¡¹ç›®ä¸­å®‰è£…Mochaï¼š`npm install --save-dev mocha`ã€‚ä½¿ç”¨æ–¹å¼ï¼ˆæŸ¥çœ‹ç‰ˆæœ¬ï¼‰ï¼šâ‘ `./node_modules/.bin/mocha --version`ï¼›â‘¡`npx mocha --version`ã€‚

Chai æ˜¯ä¸€ä¸ªé’ˆå¯¹Node.jså’Œæµè§ˆå™¨çš„è¡Œä¸ºé©±åŠ¨æµ‹è¯•å’Œæµ‹è¯•é©±åŠ¨æµ‹è¯•çš„**æ–­è¨€åº“**ï¼Œå¯ä¸ä»»ä½• JavaScript æµ‹è¯•æ¡†æ¶é›†æˆï¼Œæ˜¯Mochaçš„å¥½å¸®æ‰‹ã€‚å®‰è£…ï¼š`npm install --save-dev chai`ã€‚å…³äºæ–­è¨€ï¼š`expect`æ–­è¨€çš„ä¼˜ç‚¹æ˜¯å¾ˆæ¥è¿‘è‡ªç„¶è¯­è¨€ï¼ˆé™¤æ­¤ä¹‹å¤–ï¼Œè¿˜æœ‰shouldè¯­æ³•å’Œassetè¯­æ³•ï¼‰ã€‚ä¾‹å­ï¼š

```js
// ä½¿ç”¨æ–¹å¼ï¼š
const expect = require('chai').expect // commonjs // // æˆ–ä½¿ç”¨ï¼šimport { expect } from 'chai' // es6ï¼Œéœ€è¦å®‰è£…ç›¸å…³ä¾èµ–
// ç›¸ç­‰æˆ–ä¸ç›¸ç­‰
expect(4 + 5).to.be.equal(9);
expect(4 + 5).to.be.not.equal(10);
expect(foo).to.be.deep.equal({ bar: 'baz' });
// å¸ƒå°”å€¼ä¸ºtrue
expect('everthing').to.be.ok;
expect(false).to.not.be.ok;
// typeof
expect('test').to.be.a('string');
expect({ foo: 'bar' }).to.be.an('object');
expect(foo).to.be.an.instanceof(Foo);
// include
expect([1,2,3]).to.include(2);
expect('foobar').to.contain('foo');
expect({ foo: 'bar', hello: 'universe' }).to.include.keys('foo');
// empty
expect([]).to.be.empty;
expect('').to.be.empty;
expect({}).to.be.empty;
// match
expect('foobar').to.match(/^foo/);
```

### æµ‹è¯•å‘½ä»¤

å¦‚æœæµ‹è¯•å•ä¸€çš„æµ‹è¯•jsï¼Œå¯ä»¥ç”¨`mocha test/index.test.js`ï¼›å¦‚æœæµ‹è¯•å¤šä¸ªjsï¼Œåˆ™`mocha test/index.test.js test/add.test.js`ã€‚

ä¹Ÿå¯ä»¥ç”¨é€šé…ç¬¦æµ‹è¯•æŸä¸ªæ–‡ä»¶å¤¹ä¸‹æ‰€æœ‰çš„jså’Œjsxï¼šâ‘ nodeé€šé…ç¬¦ï¼š`mocha 'test/some/*.@(js|jsx)'`ï¼ˆè¡¨ç¤ºåŒ¹é…åˆ°testç›®å½•ä¸‹çš„someæ–‡ä»¶å¤¹ä¸‹çš„ä»¥jsæˆ–jsxä¸ºåç¼€çš„æ–‡ä»¶ï¼‰ï¼›â‘¡shellé€šé…ç¬¦ï¼š`mocha test/unit/*.js` æˆ– `mocha spec/{my,awesome}.js`ï¼ˆåŒ¹é…å…¶ä¸­ä¸€ä¸ªå­—ç¬¦ä¸²ï¼‰ã€‚

### æµ‹è¯•æ¡ˆä¾‹

![image-20230819010846298](README.assets/image-20230819010846298.png)

```js
// src/index.jsæ–‡ä»¶ï¼ˆé‡Œçš„æµ‹è¯•ä»£ç ï¼‰ï¼š
/**
 * åŠ æ³•å‡½æ•°
 * @param {ç¬¬ä¸€ä¸ªæ•°} a
 * @param {ç¬¬äºŒä¸ªæ•°} b
 */
function addNum(a,b) {
    return a + b;
}
module.exports = addNum;
```

```js
// test/demo.jsæ–‡ä»¶ï¼ˆæµ‹è¯•è„šæœ¬ï¼ŒMochaä¼šé»˜è®¤åœ¨testç›®å½•ä¹‹ä¸‹æ‰§è¡Œæµ‹è¯•ç”¨ä¾‹ï¼‰
// æ¡ˆä¾‹ä¸€ï¼Œæ§åˆ¶å°æ‰“å°ç»“æœå¦‚ä¸‹å›¾ä¸€ï¼š
const addNum = require('../src/index') // æˆ–ä½¿ç”¨import { addNum } from '../src/index'
const expect = require('chai').expect
describe('æµ‹è¯•index.js', function () {
  // test suiteã€‚æµ‹è¯•åŒºå—ï¼Œå¯ä»¥è¿›è¡ŒåµŒå¥—
  describe('æµ‹è¯•addNumå‡½æ•°', function () {
    // test case
    // beforeEach fn
    it('ä¸¤ä¸ªå‚æ•°ç›¸åŠ ç»“æœä¸ºä¸¤ä¸ªæ•°å­—çš„å’Œ', function () { // itæ‰ä»£è¡¨å®é™…çš„æ¯ä¸€ä¸ªçš„æµ‹è¯•ç”¨ä¾‹
      expect(addNum(1, 2)).to.be.equal(3);
    }) // afterEach fn
    // beforeEach fn
    it('ä¸¤ä¸ªå‚æ•°ç›¸åŠ ç»“æœä¸ä¸ºå’Œä»¥å¤–çš„æ•°', function () {
      expect(addNum(1, 2)).to.be.not.equal(4);
    }) // afterEach fn
  })
  // beforeEach fn
  it('true is not equal false', function () {
    expect(addNum(true)).to.be.not.equal(false);
  }) // afterEach fn
})
// after fn

// æ¡ˆä¾‹äºŒï¼Œæ§åˆ¶å°æ‰“å°ç»“æœå¦‚ä¸‹å›¾äºŒï¼š
......
describe('æµ‹è¯•index.js', function () {
  it('ä¸¤ä¸ªå‚æ•°ç›¸åŠ ç»“æœä¸ºä¸¤ä¸ªæ•°å­—çš„å’Œ', function () {
    expect(addNum(1, 2)).to.be.equal(3);
  })
  it('ä¸¤ä¸ªå‚æ•°ç›¸åŠ ç»“æœä¸ä¸ºå’Œä»¥å¤–çš„æ•°', function () {
    expect(addNum(1, 2)).to.be.not.equal(4);
  })
  it('ä¸¤ä¸ªå‚æ•°ç›¸åŠ ç»“æœä¸ä¸ºå’Œä»¥å¤–çš„æ•°111', function () {
    expect(addNum(1, 2)).to.be.not.equal(3);
  })
})......
```

![image-20230819011406786](README.assets/image-20230819011406786.png)

![image-20230819011737342](README.assets/image-20230819011737342.png)

### ES6è¯­æ³•æ”¯æŒ

â‘ å°†ä»£ç ä¿®æ”¹ä¸ºé‡‡ç”¨ES6çš„è¯­æ³•ï¼š

```js
// index.jsæ–‡ä»¶ï¼š
function addNum(a, b) {
  return a + b
}
export {
  addNum
}
```

```js
// test/demo.jsæ–‡ä»¶ï¼š
import { expect } from 'chai'
import { addNum } from '../src/index'
......
```

â‘¡éœ€è¦å®‰è£…babelï¼ˆå¦åˆ™ç›´æ¥è¿è¡Œmochaä¼šæŠ¥é”™ï¼‰ï¼š`npm install --save-dev @babel/cli @babel/core @babel/node @babel/register @babel/preset-env chai mocha nodemon`ï¼ˆå‰äº”ä¸ªæ˜¯ï¼‰ã€‚

â‘¢åœ¨é¡¹ç›®ç›®å½•ä¸‹æ–°å»º`.babelrc`æ–‡ä»¶ï¼š

```json
{
  "presets": ["@babel/preset-env"]
}
```

â‘£å¯ä¿®æ”¹package.jsonä¸­çš„`scripts`è„šæœ¬åè¿è¡Œï¼šå…¶ä¸­testå‘½ä»¤è¡¨ç¤ºä½¿ç”¨mochaæ—¶è¦ä½¿ç”¨bableæ’ä»¶è¿›è¡Œè¯­æ³•è½¬ä¹‰ï¼›buildå‘½ä»¤è¡¨ç¤ºä½¿ç”¨bableè¿›è¡Œæ‰“åŒ…åçš„æ–‡ä»¶çš„è¾“å‡ºç›®å½•ä¿®æ”¹ä¸ºæ ¹ç›®å½•ä¸‹çš„distæ–‡ä»¶å¤¹ä¸‹ï¼Œå¹¶æ‰“å¼€sourcemapsã€‚

```json
......
"scripts": {
  "test": "mocha --require @babel/register",
  "build": "bable src --out-dir ./dist --source-maps"
},......
```

### è¶…æ—¶

å®˜æ–¹é»˜è®¤çš„è¶…æ—¶æ˜¯2000æ¯«ç§’ï¼ˆ2sï¼‰ã€‚ä¿®æ”¹è¶…æ—¶çš„æ–¹å¼ï¼š

â‘ ä½¿ç”¨`--no-timeout`å‚æ•°æˆ–åœ¨`debug`æ¨¡å¼ä¸­ï¼Œå…¨å±€ç¦ç”¨è¶…æ—¶ï¼›

â‘¡åœ¨`--timeout`åé¢æ¥æ—¶é—´ï¼ˆæ¯«ç§’ï¼‰ï¼Œå…¨å±€ä¿®æ”¹æœ¬æ¬¡æ‰§è¡Œæµ‹è¯•ç”¨ä¾‹çš„è¶…æ—¶æ—¶é—´ï¼›

â‘¢åœ¨æµ‹è¯•ç”¨ä¾‹é‡Œä½¿ç”¨`this.timeout`æ–¹æ³•ï¼ˆé€‚åˆåœ¨é•¿æ—¶é—´çš„æµ‹è¯•ç”¨ä¾‹é‡Œï¼Œä½¿ç”¨å±€éƒ¨çš„è¶…æ—¶è®¾ç½®ï¼‰ï¼š

```js
it('should take less than 500ms', function(done) {
  this.timeout(500); // å¦å¤–ï¼Œå¯ä»¥ä½¿ç”¨ this.timeout(0) ç¦ç”¨è¶…æ—¶
  setTimeout(done, 300);
});
```

â‘£åœ¨[é’©å­æ–¹æ³•](#é’©å­æ–¹æ³•ï¼ˆç”Ÿå‘½å‘¨æœŸå‡½æ•°ï¼‰)é‡Œä½¿ç”¨ï¼š

```js
describe('a suite of tests', function() {
  beforeEach(function(done) {
    this.timeout(3000); // A very long environment setup.
    setTimeout(done, 2500);
  });
});
```

### é’©å­æ–¹æ³•

```js
// åœ¨describeå—ä¹‹ä¸­ï¼Œæä¾›æµ‹è¯•ç”¨ä¾‹çš„å››ä¸ªé’©å­æ–¹æ³•ï¼ˆç”Ÿå‘½å‘¨æœŸå‡½æ•°ï¼šbefore()ã€after()ã€beforeEach()ã€afterEach()ï¼‰ï¼Œä¼šåœ¨æŒ‡å®šæ—¶é—´æ‰§è¡Œ
describe('æµ‹è¯•index.js',()=> {
  before(()=>console.info("åœ¨æœ¬åŒºå—çš„æ‰€æœ‰æµ‹è¯•ç”¨ä¾‹ä¹‹å‰æ‰§è¡Œ"))
  after(()=>console.info("åœ¨æœ¬åŒºå—çš„æ‰€æœ‰æµ‹è¯•ç”¨ä¾‹ä¹‹åæ‰§è¡Œ"))
  beforeEach(()=>console.info("åœ¨æœ¬åŒºå—çš„æ¯ä¸ªæµ‹è¯•ç”¨ä¾‹ä¹‹å‰æ‰§è¡Œ"))
  afterEach(()=>console.info("åœ¨æœ¬åŒºå—çš„æ¯ä¸ªæµ‹è¯•ç”¨ä¾‹ä¹‹åæ‰§è¡Œ"))
  describe('æµ‹è¯•addNumå‡½æ•°', ()=> {
    it('ä¸¤ä¸ªå‚æ•°ç›¸åŠ ç»“æœä¸ºä¸¤ä¸ªæ•°å­—çš„å’Œ', function () {
      expect(addNum(1, 2)).to.be.equal(3);
    })
    it('ä¸¤ä¸ªå‚æ•°ç›¸åŠ ç»“æœä¸ä¸ºå’Œä»¥å¤–çš„æ•°', function () {
      expect(addNum(1, 2)).to.be.not.equal(4);
    })
  })
})......
```

<img src="README.assets/image-20230820234713781.png" alt="image-20230820234713781" style="zoom:80%;" />

### å¼‚æ­¥æµ‹è¯•

Mochaæ˜¯æ”¯æŒå¼‚æ­¥æµ‹è¯•çš„ï¼š

â‘ å¯ä»¥ä¸º`describe`å›è°ƒå‡½æ•°æ·»åŠ ä¸€ä¸ª`done`å‚æ•°ï¼Œ æˆåŠŸæ—¶è°ƒç”¨`done()`ï¼Œå¤±è´¥æ—¶è°ƒç”¨`done(err)`ã€‚ä¾‹å­ï¼š

```js
var expect = require('chai').expect;
describe('db', function() {
    // Mochaåˆ¤æ–­å›è°ƒå‡½æ•°çš„å½¢å‚ä¸ªæ•°çš„æ–¹å¼ï¼ˆåˆ¤æ–­æ˜¯å¦è¦ç­‰å¾…å¼‚æ­¥æ–­è¨€ï¼‰ï¼šJavaScriptä¸­çš„Functionæœ‰ä¸€ä¸ª`length`å±æ€§ï¼Œé€šè¿‡ä¼ å…¥å›è°ƒçš„`length`å¯ä»¥è·å¾—è¯¥å‡½æ•°çš„å½¢å‚ä¸ªæ•°ï¼Œåˆ¤æ–­æ˜¯å¦éœ€è¦ç­‰å¾…ã€‚
    it('#get', function(done) { // å¦‚æœæœªæ·»åŠ `done`å‚æ•°ï¼ŒMochaä¼šç›´æ¥è¿”å›æˆåŠŸï¼Œä¸ä¼šæ•è·åˆ°å¼‚æ­¥çš„æ–­è¨€å¤±è´¥
        db.get('foo', function(err, foo){
            if(err) done(err);        
            expect(foo).to.equal('bar');
            done(); // å¦‚æœæœªè°ƒç”¨`done`å‡½æ•°ï¼ŒMochaä¼šä¸€ç›´ç­‰å¾…ç›´åˆ°è¶…æ—¶
        });
    });
});
// è¿è¡Œè¯¥æµ‹è¯•Mochaä¼šæç¤ºPassing
```

â‘¡å¯ä»¥è¿”å›Promiseï¼ˆè€Œä¸æ˜¯ä½¿ç”¨å›è°ƒï¼‰ã€‚ä¾‹å­ï¼š

```js
beforeEach(function() {
  return db.clear().then(function() {
    return db.save([tobi, loki, jane]);
  });
});
describe('#find()', function() {
  it('respond with matching records', function() {
    return db.find({type: 'User'}).should.eventually.have.length(3);
  });
});
```

â‘¢å¯ä»¥ä½¿ç”¨ async / awaitï¼ˆæ³¨æ„ï¼šéœ€è¦Babelæ”¯æŒï¼‰ã€‚ä¾‹å­ï¼š

```js
beforeEach(async function() {
  await db.clear();
  await db.save([tobi, loki, jane]);
});
describe('#find()', function() {
  it('responds with matching records', async function() {
    const users = await db.find({type: 'User'});
    users.should.have.length(3);
  });
});
```

### ç¤ºä¾‹é¡¹ç›®

<img src="README.assets/image-20230822213732601.png" alt="image-20230822213732601" style="zoom:80%;" />

**åˆ›å»ºé¡¹ç›®å’Œå®‰è£…ä¾èµ–ï¼š**åˆå§‹åŒ–ä¸€ä¸ªnodejsé¡¹ç›®ï¼Œ`npm init -y`ï¼Œå½¢æˆ`package.json`æ–‡ä»¶ï¼›å®‰è£…ä¾èµ–ï¼Œ`npm install --save-dev @babel/cli @babel/core @babel/node @babel/register @babel/preset-env chai mocha nodemon`ã€‚

**æµ‹è¯•è¿‡ç¨‹ï¼š**

â‘ æ–°å»ºå¾…æµ‹è¯•çš„æ–‡ä»¶ï¼ˆ`src/index.js`ï¼‰ï¼š

```js
const sayHello = () => "Hello world!!!"
console.log(sayHello())
export default sayHello
```

â‘¡æ–°å»ºæµ‹è¯•è„šæœ¬æ–‡ä»¶ï¼ˆ`test/index.spec.js`ï¼‰ï¼š

```js
import { expect } from "chai"
import sayHello from "../src/index"
describe("index test", () => {
  describe("sayHello function", () => {
    it("should say Hello world!!!", () => {
      const str = sayHello();
      expect(str).to.equal("Hello world!!!")
    })
  })
})
```

â‘¢åœ¨`package.json`ä¸­æ–°å¢è„šæœ¬ï¼š

```json
  "scripts": {
    // "start": "nodemon ./src/index.js",  // é’ˆå¯¹ES5è¯­æ³•
    "start:babel": "nodemon --exec babel-node ./src/index.js", // å®æ—¶ç›‘å¬ï¼Œèƒ½å¤Ÿå®æ—¶ç”¨babel-nodeæ‰§è¡Œindex.jsæ–‡ä»¶
    "test": "mocha --require @babel/register", // ç”¨ä¸Šbabelè§£æES6è¯­æ³•
    "test:watch": "mocha --require @babel/register --watch", // mochaè‡ªå¸¦çš„å®æ—¶ç›‘å¬åŠŸèƒ½ï¼Œèƒ½å¤Ÿå®æ—¶è¿›è¡Œæµ‹è¯•
    "report": "mocha --require @babel/register --reporter mochawesome",
    "build": "babel src --out-dir ./dist --source-maps",
    "serve": "node ./dist/index.js",
    "debug": "node --inspect-brk ./dist/index.js"
  },
```

â‘£å¼€å§‹æµ‹è¯•ï¼š

<img src="README.assets/image-20230822212229037.png" alt="image-20230822212229037" style="zoom:80%;" />

<img src="README.assets/image-20230822211320736.png" alt="image-20230822211320736" style="zoom:80%;" />

â‘¤ä¿®æ”¹index.jsæ–‡ä»¶ï¼š`const sayHello = () => "Hello world!!"ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚`ã€‚ç»“æœï¼šæŠ¥é”™äº†ï¼Œå› ä¸ºæœŸæœ›çš„å€¼ä¸å®é™…å€¼ä¸ä¸€è‡´ã€‚

<img src="README.assets/image-20230822212750821.png" alt="image-20230822212750821" style="zoom:80%;" />

â‘¥ä½¿ç”¨`mochawesome`å±•ç¤ºä½ çš„æµ‹è¯•ç»“æœï¼š

<img src="README.assets/image-20230822213649834.png" alt="image-20230822213649834" style="zoom:80%;" />

å®‰è£…ï¼š`npm install --save-dev mochawesome`ã€‚ç„¶åæ‰§è¡Œ`npm run report`ï¼Œå°±ä¼šç”Ÿæˆ`mochawesome-report`ç›®å½•å’Œç›¸å…³æ–‡ä»¶ã€‚æŠŠå½¢æˆå‡ºæ¥çš„æŠ¥å‘Šåœ¨æµè§ˆå™¨ä¸­æ‰“å¼€ï¼š

<img src="README.assets/image-20190707212821248.png" alt="image-20190707212821248" style="zoom: 50%;" />



## Jest

<img src="README.assets/image-20230826010239324.png" alt="image-20230826010239324" style="zoom:80%;" />

<img src="README.assets/image-20230826230134264.png" alt="image-20230826230134264" style="zoom:80%;" />

Jestæ˜¯ç”±Facebookå‘å¸ƒçš„ã€å¼€æºçš„ã€åŸºäº[Jasmine](http://jasmine.github.io/)çš„JavaScriptå•å…ƒæµ‹è¯•æ¡†æ¶ï¼ŒJestä¸Jasmineæ¡†æ¶çš„åŒºåˆ«æ˜¯åœ¨åè€…ä¹‹ä¸Šå¢åŠ äº†ä¸€äº›å±‚ã€‚Jestçš„ç›®æ ‡æ˜¯å‡å°‘å¼€å§‹æµ‹è¯•ä¸€ä¸ªé¡¹ç›®æ‰€è¦èŠ±è´¹çš„æ—¶é—´å’Œè®¤çŸ¥è´Ÿè·ï¼Œå› æ­¤å®ƒæä¾›äº†å¤§éƒ¨åˆ†éœ€è¦çš„ç°æˆå·¥å…·ï¼šå¿«é€Ÿçš„å‘½ä»¤è¡Œæ¥å£ã€Mockå·¥å…·é›†ä»¥åŠå®ƒçš„è‡ªåŠ¨æ¨¡å—Mockç³»ç»Ÿã€‚å¦å¤–ï¼Œå¦‚æœåœ¨å¯»æ‰¾éš”ç¦»å·¥å…·ï¼ˆå¦‚Mockåº“ï¼‰ï¼Œå¤§éƒ¨åˆ†å…¶å®ƒå·¥å…·å°†åœ¨æµ‹è¯•ä¸­ï¼ˆç”šè‡³ç»å¸¸åœ¨ä¸»ä»£ç ä¸­ï¼‰å†™ä¸€äº›ä¸å°½å¦‚äººæ„çš„æ ·æ¿ä»£ç ï¼Œä»¥ä½¿å…¶ç”Ÿæ•ˆã€‚è¿è¡Œæµ‹è¯•æ—¶ï¼ŒJestä¼šè‡ªåŠ¨æ¨¡æ‹Ÿä¾èµ–ã€‚Jestè‡ªåŠ¨ä¸ºæ¯ä¸ªä¾èµ–çš„æ¨¡å—ç”ŸæˆMockï¼Œå¹¶é»˜è®¤æä¾›è¿™äº›Mockï¼Œè¿™æ ·å°±å¯ä»¥å¾ˆå®¹æ˜“åœ°éš”ç¦»æ¨¡å—çš„ä¾èµ–ã€‚

ç‰¹ç‚¹ï¼š

â‘ Jestæ”¯æŒBabelï¼Œä½¿ç”¨ES6çš„é«˜çº§è¯­æ³•ï¼ˆ[babelå®˜ç½‘](https://babeljs.io/)ï¼‰ï¼›æ”¯æŒwebpackï¼Œç”¨å®ƒç®¡ç†é¡¹ç›®æ›´æ–¹ä¾¿ï¼›æ”¯æŒTypeScriptï¼Œè®©ä¹¦å†™æµ‹è¯•ç”¨ä¾‹æ›´ä¸¥è°¨ï¼ˆ[Using Typescript](https://jestjs.io/docs/en/getting-started#using-typescript)ï¼‰ã€‚

â‘¡ç®€åŒ–APIï¼šJestç®€å•ã€å¼ºå¤§ã€å¼€ç®±å³ç”¨ã€‚å†…ç½®æ”¯æŒçš„åŠŸèƒ½æœ‰ï¼š
çµæ´»çš„é…ç½®ï¼ˆå¦‚å¯ç”¨æ–‡ä»¶åé€šé…ç¬¦æ¥æ£€æµ‹æµ‹è¯•æ–‡ä»¶ï¼‰ï¼›
æµ‹è¯•çš„äº‹å‰æ­¥éª¤ï¼ˆSetupï¼‰å’Œäº‹åæ­¥éª¤ï¼ˆTeardownï¼‰ï¼ŒåŒæ—¶ä¹ŸåŒ…æ‹¬æµ‹è¯•èŒƒå›´ï¼›
åŒ¹é…è¡¨è¾¾å¼ï¼ˆMatchersï¼‰ï¼Œèƒ½ä½¿ç”¨æœŸæœ›`expect`å¥æ³•æ¥éªŒè¯ä¸åŒçš„å†…å®¹ï¼›
æµ‹è¯•å¼‚æ­¥ä»£ç ï¼Œæ”¯æŒpromiseæ•°æ®ç±»å‹å’Œå¼‚æ­¥ç­‰å¾…`async` / `await`åŠŸèƒ½ï¼›
æ¨¡æ‹Ÿå‡½æ•°ï¼Œå¯ä¿®æ”¹æˆ–ç›‘æŸ¥æŸä¸ªå‡½æ•°çš„è¡Œä¸ºï¼›
æ‰‹åŠ¨æ¨¡æ‹Ÿï¼Œæµ‹è¯•ä»£ç æ—¶å¯ä»¥å¿½ç•¥æ¨¡å—çš„ä¾å­˜å…³ç³»ï¼›
è™šæ‹Ÿè®¡æ—¶ï¼Œå¸®åŠ©æ§åˆ¶æ—¶é—´æ¨ç§»ã€‚

â‘¢æ€§èƒ½ä¸éš”ç¦»ï¼šJestèƒ½è¿ç”¨æ‰€æœ‰çš„å·¥ä½œéƒ¨åˆ†ï¼Œå¹¶åˆ—è¿è¡Œæµ‹è¯•ï¼ˆå³å¹¶è¡Œæµ‹è¯•ï¼Œè€ŒMochaç”¨ä¸€ä¸ªè¿›ç¨‹è¿è¡Œæ‰€æœ‰çš„æµ‹è¯•ï¼‰ï¼Œä½¿æ€§èƒ½æœ€å¤§åŒ–ï¼ˆç¼ºç‚¹æ˜¯åƒå†…å­˜ï¼‰ã€‚ç»ˆç«¯ä¸Šçš„ä¿¡æ¯ç»è¿‡ç¼“å†²ï¼Œæœ€åä¸æµ‹è¯•ç»“æœä¸€èµ·æ‰“å°å‡ºæ¥ã€‚æ²™ç›’ä¸­ç”Ÿæˆçš„æµ‹è¯•æ–‡ä»¶ï¼Œä»¥åŠåœ¨æ¯ä¸ªæµ‹è¯•é‡Œï¼Œè‡ªåŠ¨å…¨å±€çŠ¶æ€éƒ½ä¼šå¾—åˆ°é‡ç½®ï¼Œè¿™æ ·å°±ä¸ä¼šå‡ºç°ä¸¤ä¸ªæµ‹è¯•å†²çªçš„æƒ…å†µã€‚

â‘£æ²‰æµ¸å¼ç›‘æ§æ¨¡å¼ï¼š

å¿«é€Ÿäº’åŠ¨å¼ç›‘æ§æ¨¡å¼å¯ä»¥ç›‘æ§åˆ°æµ‹è¯•æ–‡ä»¶çš„æ”¹åŠ¨ï¼Œå¯ä»¥åªè¿è¡Œä¸æ”¹åŠ¨è¿‡çš„æ–‡ä»¶ç›¸å…³çš„æµ‹è¯•ï¼Œå¹¶ä¸”ç”±äºä¼˜åŒ–ä½œç”¨ï¼Œèƒ½è¿…é€Ÿæ”¾å‡ºç›‘æ§ä¿¡å·ã€‚è®¾ç½®ç®€å•ï¼Œè€Œä¸”æœ¬èº«è¿˜æä¾›å…¶å®ƒé€‰é¡¹ï¼Œå¯ä»¥ç”¨æ–‡ä»¶åæˆ–æµ‹è¯•åæ¥è¿‡æ»¤æµ‹è¯•ï¼ˆMochaæ—¶ä¹Ÿæœ‰ç›‘æ§æ¨¡å¼ï¼Œä¸è¿‡æ²¡æœ‰é‚£ä¹ˆå¼ºå¤§ï¼Œè¦è¿è¡ŒæŸä¸ªç‰¹å®šçš„æµ‹è¯•æ–‡ä»¶å¤¹æˆ–æ–‡ä»¶ï¼Œå°±è¦ç”¨å…¶å®ƒè§£å†³æ–¹æ³•ï¼‰ã€‚

â‘¤ä»£ç è¦†ç›–ç‡å’Œæµ‹è¯•æŠ¥å‘Šï¼šJestå†…ç½®æœ‰ä»£ç è¦†ç›–ç‡æŠ¥å‘ŠåŠŸèƒ½ï¼Œè®¾ç½®ç®€å•ï¼Œå¯ä»¥åœ¨æ•´ä¸ªé¡¹ç›®èŒƒå›´é‡Œæ”¶é›†ä»£ç è¦†ç›–ç‡ä¿¡æ¯ï¼ˆåŒ…æ‹¬æœªç»å—æµ‹è¯•çš„æ–‡ä»¶ï¼‰ã€‚è¦ä½¿å®Œå–„Circle CIæ•´åˆï¼Œåªè¦ä¸€ä¸ªè‡ªå®šä¹‰æŠ¥å‘ŠåŠŸèƒ½ï¼Œç”¨[jest-junit-reporter](https://github.com/michaelleeallen/jest-junit-reporter)å°±å¯ä»¥åšåˆ°ï¼ˆç”¨æ³•å’ŒMochaå‡ ä¹ç›¸åŒï¼‰ã€‚

â‘¥å¿«ç…§åŠŸèƒ½ï¼ˆå¿«ç…§æµ‹è¯•çš„ç›®çš„ä¸æ˜¯è¦æ›¿æ¢ç°æœ‰çš„å•å…ƒæµ‹è¯•ï¼Œè€Œæ˜¯è¦ä½¿ä¹‹æ›´æœ‰ä»·å€¼ï¼Œè®©æµ‹è¯•æ›´è½»æ¾ï¼‰ï¼šåœ¨æŸäº›æƒ…å†µä¸‹ï¼ŒæŸäº›åŠŸèƒ½ï¼ˆå¦‚Reactç»„ä»¶åŠŸèƒ½ï¼‰æœ‰äº†å¿«ç…§æµ‹è¯•åˆ™æ— éœ€å†åšå•å…ƒæµ‹è¯•ï¼Œä½†è¿™ä¸¤è€…ä¸æ˜¯éæ­¤å³å½¼ã€‚

### å®‰è£…

å…¨å±€å®‰è£…ï¼š`npm install -g jest`ï¼›é€šè¿‡yarnæ¥å®‰è£…ï¼š`yarn add --dev jest`ã€‚ä½¿ç”¨æ–¹å¼ï¼šç›´æ¥ä½¿ç”¨jestï¼Œä¹Ÿå¯ä»¥åœ¨package.jsonä¸­çš„`scripts`èŠ‚ç‚¹ä¸‹åŠ å…¥`"test": "jest"`è„šæœ¬æ¥è¿è¡Œã€‚

é¡¹ç›®ä¸­å®‰è£…Mochaï¼š`npm install --save-dev jest`ã€‚ä½¿ç”¨æ–¹å¼ï¼ˆæŸ¥çœ‹ç‰ˆæœ¬ï¼‰ï¼šâ‘ `./node_modules/.bin/jest --version`ï¼›â‘¡`npx jest --version`ã€‚

Jest çš„æµ‹è¯•è„šæœ¬åæ˜¯å½¢å¦‚`.test.js`æˆ–`test.js`çš„æ–‡ä»¶ï¼Œå³Jestä¼šæ‰§è¡Œå½“å‰ç›®å½•ä¸‹æ‰€æœ‰çš„`*.test.js` æˆ– `*.spec.js` æ–‡ä»¶å¹¶å®Œæˆæµ‹è¯•ã€‚

**ES6è¯­æ³•æ”¯æŒï¼š**å®‰è£…ä¾èµ–ï¼Œ`yarn add --dev babel-jest @babel/core @babel/preset-env`ï¼›é…ç½®`babel.config.js`ï¼ˆå¦‚ä¸‹ä»£ç ï¼‰ï¼ˆæˆ–é€šè¿‡åœ¨`.babelrc`æ–‡ä»¶ç›´æ¥å†™è¯¥å¯¹è±¡å³å¯ï¼‰ã€‚

```json
module.exports = {
  "presets": [
    [
      "@babel/preset-env",
      {
        "targets": {
          "node": "current"
        }
      }
    ]
  ]
}
```

### æµ‹è¯•æ¡ˆä¾‹

å…³äºtest suiteä¸test caseï¼šä¸€ä¸ªå®Œæ•´çš„é¡¹ç›®å¯ä»¥åˆ†ä¸ºå¤šä¸ªæµ‹è¯•åŒ…ï¼ˆdescribeå±äº test suite çš„æè¿°ï¼Œè€Œtest suiteå¯ä»¥è¿›è¡ŒåµŒå¥—ï¼‰ï¼Œä¸€ä¸ªæµ‹è¯•åŒ…é‡Œå¯ä»¥åŒ…å«å¤šä¸ªæµ‹è¯•ç”¨ä¾‹ï¼ˆæ¯ä¸ª test æˆ– it æè¿°äº†æ¯ä¸ª test caseï¼‰ã€‚

<img src="README.assets/w80140jb42.jpg" alt="img" style="zoom: 50%;" />

![image-20230826235203859](README.assets/image-20230826235203859.png)

```js
// src/math.jsæ–‡ä»¶ï¼š
export const add = (a, b) => a + b;
export const multiple = (a, b) => a * b;
```

```js
// test.jsæ–‡ä»¶ï¼ˆæµ‹è¯•è„šæœ¬ï¼‰ï¼š
// å¼•å…¥å¾…æµ‹è¯•çš„åŠŸèƒ½æ¨¡å—
import { add, multiple } from './src/math'
// test suite
describe("math.js testing", () => {
  // test case
  it("test add method", () => {
    const result = add(3, 4)
    expect(result).toEqual(5) // assertion
  });
  describe("testsuite", () => {
    test("test add method 3", () => {
      expect(add(1, 2)).toEqual(3)
    });
  });
});
// ç›´æ¥ä½¿ç”¨testæ–¹æ³•ï¼Œå¯ä»¥è®©test caseè„±ç¦»test suiteç‹¬ç«‹è¿è¡Œ
test("test add method 2", () => {
  expect(add(1, 2)).toEqual(3)
});
```

<img src="README.assets/image-20230826224952392.png" alt="image-20230826224952392" style="zoom:80%;" />

å¦å¤–ï¼Œä½¿ç”¨`beforeAll`é’©å­å‡½æ•°å¯ä»¥åšä¸€äº›å‰ç½®çš„æ•°æ®å‡†å¤‡çš„å·¥ä½œï¼š

```js
import { add, multiple } from './src/math'
describe("math.js testing", () => {
  let a
  let b
  beforeEach(function () {
    a = 2;
    b = 3;
  });
  it("test add method", () => {
    const result = add(a, b)
    expect(result).toEqual(5)
  });
  it("test multiple method", () => {
    const result = multiple(a, b)
    expect(result).toEqual(6)
  });
});
```

<img src="README.assets/image-20230826231843712.png" alt="image-20230826231843712" style="zoom:80%;" />

### Mockä¸Spy

**mock**æµ‹è¯•æ˜¯åœ¨æµ‹è¯•è¿‡ç¨‹ä¸­ï¼Œå¯¹äºæŸäº›ä¸å®¹æ˜“æ„é€ æˆ–è€…ä¸å®¹æ˜“è·å–çš„å¯¹è±¡ï¼Œç”¨ä¸€ä¸ªè™šæ‹Ÿçš„å¯¹è±¡æ¥åˆ›å»ºä»¥ä¾¿æµ‹è¯•çš„æµ‹è¯•æ–¹æ³•ã€‚Mock æ˜¯å•å…ƒæµ‹è¯•ï¼ˆæµ‹è¯•çš„é‡ç‚¹æ˜¯æŸä¸ªå…·ä½“å•å…ƒï¼‰ä¸­ç»å¸¸ä½¿ç”¨çš„ä¸€ç§æŠ€æœ¯ï¼Œè€Œåœ¨å®é™…ä»£ç ä¸­ï¼Œä»£ç ä¸ä»£ç ä¹‹é—´ã€æ¨¡å—ä¸æ¨¡å—ä¹‹é—´æ€»æ˜¯ä¼šå­˜åœ¨ç€ç›¸äº’å¼•ç”¨ï¼Œè¿™ä¸ªæ—¶å€™ï¼Œå‰¥ç¦»å‡ºè¿™ç§å•å…ƒçš„ä¾èµ–ï¼Œè®©æµ‹è¯•æ›´åŠ ç‹¬ç«‹ï¼Œä½¿ç”¨åˆ°çš„æŠ€æœ¯å°±æ˜¯ Mockã€‚

åœ¨é¡¹ç›®ä¸­ï¼Œä¸€ä¸ªæ¨¡å—çš„æ–¹æ³•å†…å¸¸å¸¸ä¼šå»è°ƒç”¨å¦å¤–ä¸€ä¸ªæ¨¡å—çš„æ–¹æ³•ã€‚åœ¨å•å…ƒæµ‹è¯•ä¸­ï¼Œå¯èƒ½å¹¶ä¸éœ€è¦å…³å¿ƒå†…éƒ¨è°ƒç”¨çš„æ–¹æ³•çš„æ‰§è¡Œè¿‡ç¨‹å’Œç»“æœï¼Œåªæƒ³çŸ¥é“å®ƒæ˜¯å¦è¢«æ­£ç¡®è°ƒç”¨ï¼ˆç”šè‡³ä¼šæŒ‡å®šè¯¥å‡½æ•°çš„è¿”å›å€¼ï¼‰ï¼Œæ‰€ä»¥ä½¿ç”¨Mockå‡½æ•°æ˜¯ååˆ†æœ‰å¿…è¦ã€‚

Mockå…¶å®å°±æ˜¯ä¸€ç§Spiesï¼Œåœ¨Jestä¸­ä½¿ç”¨spiesæ¥â€œspyâ€ï¼ˆçª¥æ¢ï¼‰ä¸€ä¸ªå‡½æ•°çš„è¡Œä¸ºã€‚[Jestæ–‡æ¡£](https://jestjs.io/docs/en/mock-function-api.html#content)å¯¹äºspiesçš„è§£é‡Šï¼šMockå‡½æ•°ä¹Ÿç§°ä¸ºâ€œspiesâ€ï¼Œå› ä¸ºå®ƒä»¬çª¥æ¢ä¸€äº›ç”±å…¶å®ƒä»£ç é—´æ¥è°ƒç”¨çš„å‡½æ•°çš„è¡Œä¸ºï¼Œè€Œä¸ä»…ä»…æ˜¯æµ‹è¯•è¾“å‡ºï¼Œä¸€ä¸ªspyæ˜¯å¦ä¸€ä¸ªå†…ç½®çš„èƒ½å¤Ÿè®°å½•å¯¹å…¶è°ƒç”¨ç»†èŠ‚çš„å‡½æ•°ï¼ˆå¦‚è°ƒç”¨å®ƒçš„æ¬¡æ•°ï¼Œä½¿ç”¨ä»€ä¹ˆå‚æ•°ç­‰ï¼‰ã€‚â‘ å¯ä»¥é€šè¿‡`jest.spyOn`ï¼ˆ[spyOnä»‹ç»](https://jestjs.io/docs/en/jest-object#jestspyonobject-methodname)ï¼‰å…·ä½“åœ°æ‰§è¡Œè¦ç›‘è§†çš„å‡½æ•°ï¼›â‘¡ä¹Ÿå¯ä»¥é€šè¿‡ä½¿ç”¨ `jest.fn()` åˆ›å»ºä¸€ä¸ªmockå‡½æ•°ï¼Œjest.fnæ˜¯æ¨¡æ‹Ÿäº†æ•´ä¸ªæ–¹æ³•ä»¥åŠå®ƒçš„è¿”å›å€¼ï¼ˆå½“ç„¶ä¹Ÿå¯ä»¥ç›‘è§†æ¨¡æ‹Ÿåçš„æ–¹æ³•ï¼Ÿï¼‰ã€‚

Mockå‡½æ•°æä¾›çš„ä¸‰ç§ç‰¹æ€§ï¼Œåœ¨å†™æµ‹è¯•ä»£ç æ—¶éå¸¸æœ‰ç”¨ï¼šâ‘ æ•è·å‡½æ•°è°ƒç”¨æƒ…å†µï¼›â‘¡è®¾ç½®å‡½æ•°è¿”å›å€¼ï¼›â‘¢æ”¹å˜å‡½æ•°çš„å†…éƒ¨å®ç°ã€‚

<img src="README.assets/8u3cp5kz2s.png" alt="img" style="zoom:67%;" />

#### **ä¾‹å­ä¸€ï¼š**

![image-20230828211259921](README.assets/image-20230828211259921.png)

```javascript
// test/mock.test.js
test('æµ‹è¯•jest.fn()è°ƒç”¨', () => {
  // `jest.fn()`æ˜¯åˆ›å»ºMockå‡½æ•°æœ€ç®€å•çš„æ–¹å¼ï¼Œå¦‚æœæ²¡æœ‰å®šä¹‰å‡½æ•°å†…éƒ¨çš„å®ç°ï¼Œ`jest.fn()`ä¼šè¿”å›`undefined`ä½œä¸ºè¿”å›å€¼ã€‚
  let mockFn = jest.fn();
  let result = mockFn(1, 2, 3);
  expect(result).toBeUndefined(); // æ–­è¨€mockFnçš„æ‰§è¡Œåè¿”å›undefined
  expect(mockFn).toBeCalled(); // æ–­è¨€mockFnè¢«è°ƒç”¨äº†
  expect(mockFn).toBeCalledTimes(1); // æ–­è¨€mockFnè¢«è°ƒç”¨äº†ä¸€æ¬¡
  expect(mockFn).toHaveBeenCalledWith(1, 2, 3); // æ–­è¨€mockFnä¼ å…¥çš„å‚æ•°ä¸º1, 2, 3
})
```

<img src="README.assets/image-20230828211242797.png" alt="image-20230828211242797" style="zoom:80%;" />

#### **ä¾‹å­äºŒï¼š**

![image-20230828213712235](README.assets/image-20230828213712235.png)

```js
// src/math.js
export const getFooResult = () => {
  // foo logic here
};
export const getBarResult = () => {
  // bar logic here
};
```

```js
// src/caculate.js
import { getFooResult, getBarResult } from "./math";
export const getFooBarResult = () => getFooResult() + getBarResult();
```

â‘ æƒ…æ™¯ä¸€ï¼šè®¾ç½®å‡½æ•°çš„è¿”å›å€¼ï¼š

```js
// test/calculate.test.js
import { getFooBarResult } from "./calculate";
// getFooResult() å’Œ getBarResult() æ˜¯ getFooBarResult å‡½æ•°çš„ä¾èµ–ã€‚
// å¦‚æœå…³æ³¨ç‚¹æ˜¯getFooBarResultï¼Œåˆ™åº”è¯¥æŠŠgetFooResultå’ŒgetBarResultç»™Mockæ‰ï¼Œå‰¥ç¦»è¿™ç§ä¾èµ–ã€‚
import * as fooBar from './math';
test('getResult should return result getFooResult() + getBarResult()', () => {
  // è¿›è¡Œmock
  fooBar.getFooResult = jest.fn(() => 10);
  fooBar.getBarResult = jest.fn(() => 5);
  const result = getFooBarResult();
  expect(result).toEqual(15);
  // ç›‘æ§getFooResultå’ŒgetBarResultçš„è°ƒç”¨æƒ…å†µ.
  expect(fooBar.getFooResult).toHaveBeenCalled();
  expect(fooBar.getBarResult).toHaveBeenCalled();
});
```

<img src="README.assets/image-20230828211641815.png" alt="image-20230828211641815" style="zoom:80%;" />

â‘¡æƒ…æ™¯äºŒï¼šæ•è·å‡½æ•°è°ƒç”¨æƒ…å†µï¼š

```js
// test/sayhello.test.js
const bot = { // bot method
  sayHello: name => {
    console.log(`Hello ${name}!`);
  }
};
describe("test bot Object", () => {
  it("should say hello to the Name", () => {
    // é€šè¿‡ `jest.spyOn` åˆ›å»ºäº†ä¸€ä¸ªç›‘å¬ `bot` å¯¹è±¡çš„ `sayHello` æ–¹æ³•çš„ spyï¼Œç›‘å¬äº†æ‰€æœ‰å¯¹ `bot#sayHello` æ–¹æ³•çš„è°ƒç”¨ã€‚
    const spy = jest.spyOn(bot, "sayHello");
    bot.sayHello("itheima");
    expect(spy).toHaveBeenCalledWith("itheima");
    // ç”±äºåˆ›å»ºspyæ—¶ï¼ŒJestå®é™…ä¸Šä¿®æ”¹äº†`bot`å¯¹è±¡çš„`sayHello`å±æ€§ï¼ˆåŒ…æ‹¬jest.fn()ä¹Ÿæ˜¯ä¿®æ”¹äº†åŸæ¥å±æ€§ï¼Ÿï¼‰
    // åœ¨æ–­è¨€å®Œæˆåï¼Œè¦é€šè¿‡`mockRestore`æ¥æ¢å¤`bot`å¯¹è±¡åŸæœ¬çš„`sayHello`æ–¹æ³•ï¼Œå¦åˆ™åœ¨åé¢çš„æµ‹è¯•å®ä¾‹ä¸­ä¼šå—åˆ°å½±å“ã€‚
    spy.mockRestore();
  });
});
```

<img src="README.assets/image-20230828212116133.png" alt="image-20230828212116133" style="zoom:80%;" />

â‘¢æƒ…æ™¯ä¸‰ï¼šä¿®æ”¹å‡½æ•°çš„å†…å®¹å®ç°ï¼š

```js
// test/sayhello.test.js
const bot = {
  sayHello: name => {
    console.log(`Hello ${name}!`);
  }
};
describe("test bot Object", () => {
  it("should say hello to the Name", () => {
    const spy = jest.spyOn(bot, "sayHello").mockImplementation(name => {
      console.log(`Hello mix ${name}`)
    });
    bot.sayHello("itheima");
    expect(spy).toHaveBeenCalledWith("itheima");
    // spy.mockRestore(); // è‹¥å–æ¶ˆè¯¥æ¢å¤çš„æ³¨é‡Šï¼Œåˆ™ç»“æœå¦‚ä¸‹å›¾äºŒï¼ˆå› ä¸ºmockRestoreä¹‹åçš„`bot.sayHello`ä¸å†è¢«spyï¼Œæ‰€ä»¥ä¼šæŠ¥é”™ï¼‰
  });
  it("should be hello name", () => {
    bot.sayHello("itheima1");
    expect(bot.sayHello).toHaveBeenCalled;
  });
});
```

<img src="README.assets/image-20230909005205398.png" alt="image-20230909005205398" style="zoom:80%;" />

<img src="README.assets/image-20230909010038744.png" alt="image-20230909010038744" style="zoom:80%;" />

æ‹“å±•ï¼šä½¿ç”¨spyOnæ–¹æ³•ï¼Œè¿˜å¯ä»¥å»ä¿®æ”¹Math.randomè¿™æ ·çš„å‡½æ•°ã€‚ä¾‹å­ï¼š

```js
// getNum.js
const arr = [1,2,3,4,5,6];
const getNum = index => {
  if (index) {
    return arr[index % 6];
  } else {
    return arr[Math.floor(Math.random() * 6)];
  }
};

// num.test.js
import { getNum } from '../src/getNum'
describe("getNum", () => {
  it("should select numbber based on index if provided", () => {
    expect(getNum(1)).toBe(2);
  });
  it("should select a random number based on Math.random if skuId not available", () => {
    const spy = jest.spyOn(Math, "random").mockImplementation(() => 0.9);
    expect(getNum()).toBe(6);
    expect(spy).toHaveBeenCalled();
    spy.mockRestore();
  });
});
```

### CLIå‘½ä»¤

```
âœ npx jest --help
Usage: jest [--config=<pathToConfigFile>] [TestPathPattern]

é€‰é¡¹ï¼š
  --help, -h                    æ˜¾ç¤ºå¸®åŠ©ä¿¡æ¯                              [å¸ƒå°”]
  --version, -v                 Print the version and exit                [å¸ƒå°”]
  --config, -c                  The path to a jest config file specifying how to
                                find and execute tests. If no rootDir is set in
                                the config, the directory containing the config
                                file is assumed to be the rootDir for the
                                project.This can also be a JSON encoded value
                                which Jest will use as configuration.   [å­—ç¬¦ä¸²]
  --coverage                    Indicates that test coverage information should
                                be collected and reported in the output.  [å¸ƒå°”] 
  --timers                      Setting this value to fake allows the use of
                                fake timers for functions such as setTimeout.
                                                                        [å­—ç¬¦ä¸²]
  --verbose                     Display individual test results with the test
                                suite hierarchy.                          [å¸ƒå°”]
  --watch                       Watch files for changes and rerun tests related
                                to changed files. If you want to re-run all
                                tests when a file has changed, use the
                                `--watchAll` option.                      [å¸ƒå°”]
  --watchAll                    Watch files for changes and rerun all tests. If
                                you want to re-run only the tests related to the
                                changed files, use the `--watch` option.  [å¸ƒå°”]
...
```

å¸¸è§ä½¿ç”¨ï¼š

â‘ `--verbose`æ˜¾ç¤ºè¯¦ç»†çš„æµ‹è¯•ä¿¡æ¯ï¼ŒåŒ…æ‹¬æµ‹è¯•suiteå’Œcaseï¼š

<img src="README.assets/image-20230909213514335.png" alt="image-20230909213514335" style="zoom:80%;" />

â‘¡`--watch`å’Œ`--watchAll`ç”¨æ¥ç›‘å¬æµ‹è¯•æ–‡ä»¶çš„å˜åŒ–ï¼Œå¦‚ä½¿ç”¨watchAllä¹‹åï¼Œå¯ç›´æ¥è¾“å…¥ç›¸åº”çš„é”®å€¼å†å›è½¦æ‰§è¡Œï¼š

<img src="README.assets/image-20230909214943637.png" alt="image-20230909214943637" style="zoom:80%;" />

â‘¢`--coverage`ç”¨æ¥å½¢æˆæµ‹è¯•è¦†ç›–ç‡æŠ¥å‘Š

<img src="README.assets/image-20230909212718720.png" alt="image-20230909212718720" style="zoom:80%;" />

### Jestçš„åº”ç”¨

**â‘ Jeståœ¨Reacté¡¹ç›®ä¸­çš„åº”ç”¨ï¼š**

åœ¨`create-react-app`ä¸­çš„åº”ç”¨ï¼šå®‰è£…å¯¹åº”çš„ä¾èµ–ï¼Œ`npm install -D react-test-renderer enzyme enzyme-adapter-react-16`ã€‚

react-test-rendererä¼šæŠŠreactç»„ä»¶ä½¿ç”¨çº¯çš„jså¯¹è±¡çš„å½¢å¼æ¥è¿›è¡Œæ¸²æŸ“ï¼Œè€Œä¸æ˜¯ä¾èµ–ä¸€ä¸ªdomæˆ–åŸç”Ÿçš„ç§»åŠ¨ç«¯çš„ç¯å¢ƒã€‚
[Enzyme](https://github.com/airbnb/enzyme)æ˜¯ä¸€ä¸ªReactç»„ä»¶æµ‹è¯•æµ‹è¯•åº“ï¼ˆEnzyme is a JavaScript Testing utility for React that makes it easier to test your React Components' output. You can also manipulate, traverse, and in some ways simulate runtime given the output.    Enzyme's API is meant to be intuitive and flexible by mimicking jQuery's API for DOM manipulation and traversalï¼‰ã€‚

- è¦é…ç½®Adapterï¼Œä¸åŒçš„Reactç‰ˆæœ¬æ‰€å¯¹åº”çš„Adapterä¸åŒï¼š

  | Enzyme Adapter Package      | React semver compatibility |
  | --------------------------- | -------------------------- |
  | `enzyme-adapter-react-16`   | `^16.4.0-0`                |
  | `enzyme-adapter-react-16.3` | `~16.3.0-0`                |
  | `enzyme-adapter-react-16.2` | `~16.2`                    |
  | `enzyme-adapter-react-16.1` | `~16.0.0-0 || ~16.1`       |
  | `enzyme-adapter-react-15`   | `^15.5.0`                  |
  | `enzyme-adapter-react-15.4` | `15.0.0-0 - 15.4.x`        |
  | `enzyme-adapter-react-14`   | `^0.14.0`                  |
  | `enzyme-adapter-react-13`   | `^0.13.0`                  |


- è¦åˆå§‹åŒ–é…ç½®`setUpTests.js`ï¼Œä½¿ç”¨Jestæ¡†æ¶çš„é»˜è®¤åŠ è½½æ–‡ä»¶ï¼ˆ`src/setUpTests.js`ï¼‰æ¥è®¾ç½®jesté…ç½®ï¼š

  ```js
  import { configure } from 'enzyme';
  import Adapter from 'enzyme-adapter-react-16'
  configure({ adapter: new Adapter() })
  ```

æµ‹è¯•æ¡ˆä¾‹ï¼š

<img src="README.assets/image-20230909231801789.png" alt="image-20230909231801789" style="zoom:80%;" />

**â‘¡Jeståœ¨Vueé¡¹ç›®ä¸­çš„åº”ç”¨ï¼š**

åœ¨vueå·¥ç¨‹åŒ–é¡¹ç›®ä¸­ï¼Œæ·»åŠ ä¾èµ–å’Œé…ç½®scriptsï¼š

```json
"scripts": {
  "test": "vue-cli-service test:unit"
},
ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚
"devDependencies": {
  "@vue/cli-plugin-unit-jest": "^3.9.0",
  "@vue/test-utils": "1.0.0-beta.29",
  "babel-core": "7.0.0-bridge.0",
  "babel-eslint": "^10.0.1",
  "babel-jest": "^23.6.0",
  "babel-preset-env": "^1.7.0",
},
```

é…ç½®`jest.config.js`

```js
module.exports = {
  // å¤„ç†vueç»“å°¾çš„æ–‡ä»¶
  moduleFileExtensions: [
    'js',
    'jsx',
    'json',
    'vue'
  ],
  // es6è½¬ä¹‰
  transform: {
    '^.+\\.vue$': 'vue-jest',
    '.+\\.(css|styl|less|sass|scss|svg|png|jpg|ttf|woff|woff2)$': 'jest-transform-stub',
    '^.+\\.jsx?$': 'babel-jest'
  },
  transformIgnorePatterns: [
    '/node_modules/'
  ],
  // clié…ç½®äº†webpackåˆ«åè§£æï¼ˆå¦‚æŠŠ`@`è®¾ç½®ä¸º`/src`çš„åˆ«åï¼‰
  moduleNameMapper: {
    '^@/(.*)$': '<rootDir>/src/$1'
  },
  snapshotSerializers: [ // å¿«ç…§
    'jest-serializer-vue'
  ],
  testMatch: [
    '**/tests/unit/**/*.spec.(js|jsx|ts|tsx)|**/__tests__/*.(js|jsx|ts|tsx)'
  ],
  testURL: 'http://localhost/',
  watchPlugins: [
    'jest-watch-typeahead/filename',
    'jest-watch-typeahead/testname'
  ]
}
```

æµ‹è¯•æ¡ˆä¾‹ï¼š

<img src="README.assets/image-20230910015047522.png" alt="image-20230910015047522" style="zoom:67%;" />



## AVA

<img src="README.assets/image-20230912205808345.png" alt="image-20230912205808345" style="zoom: 80%;" />

ç®€çº¦ä¹‹ç¾AVAï¼šavaæ˜¯mochaçš„æ›¿ä»£å“ï¼š
â‘ es6è¯­æ³•æ”¯æŒæ›´å¥½ï¼Œå¯¹aysnc/awaitæœ‰æ”¯æŒï¼›
â‘¡æ‰§è¡Œæ•ˆç‡æ›´é«˜ï¼Œä½¿ç”¨ioå¹¶å‘ï¼Œè®©æµ‹è¯•å¯ä»¥å¹¶å‘æ‰§è¡Œï¼ˆå¹¶è¡Œæµ‹è¯•ï¼‰ï¼Œä¿è¯æµ‹è¯•çš„åŸå­æ€§ï¼Œæµ‹è¯•æ–‡ä»¶ä¹Ÿå¯ä»¥åœ¨ä¸åŒçš„è¿›ç¨‹é‡Œå¹¶è¡Œè¿è¡Œï¼Œè®©æ¯ä¸€ä¸ªæµ‹è¯•æ–‡ä»¶å¯ä»¥è·å¾—æ›´å¥½çš„æ€§èƒ½å’Œç‹¬ç«‹çš„ç¯å¢ƒï¼›
â‘¢è¯­ä¹‰ä¸Šæ›´ç®€å•ï¼Œé›†ä¼—å®¶ä¹‹é•¿ã€‚

ç‰¹ç‚¹ï¼šâ‘ è½»é‡å’Œé«˜æ•ˆï¼›â‘¡ç®€å•çš„æµ‹è¯•è¯­æ³•ï¼›â‘¢å¹¶å‘è¿è¡Œæµ‹è¯•ï¼›â‘£å¼ºåˆ¶ç¼–å†™**åŸå­æµ‹è¯•**ï¼ˆä¸€æ—¦å¼€å§‹ï¼Œå°±ä¸€ç›´è¿è¡Œåˆ°ç»“æŸï¼Œä¸­é—´ä¸ä¼šåˆ‡æ¢åˆ°å¦ä¸€ä¸ªæµ‹è¯•ï¼‰ï¼›â‘¤æ²¡æœ‰éšè—çš„å…¨å±€å˜é‡ï¼›â‘¥ä¸ºæ¯ä¸ªæµ‹è¯•æ–‡ä»¶éš”ç¦»ç¯å¢ƒï¼›â‘¦**ç”¨ ES2015 ç¼–å†™æµ‹è¯•**ï¼Œæ”¯æŒ Promiseï¼Œæ”¯æŒ Generatorï¼Œæ”¯æŒ Asyncï¼Œæ”¯æŒ Observableï¼›â‘§å¼ºåŒ–æ–­è¨€ä¿¡æ¯ï¼›â‘¨å¯é€‰çš„ TAP è¾“å‡ºæ˜¾ç¤ºï¼›â‘©ç®€æ˜çš„å †æ ˆè·Ÿè¸ªã€‚

**avaä¸­çš„æ–­è¨€ï¼š**

```json
.pass([message])
.fail([message])
.assert(value, [message])
.truthy(value, [message])
.falsy(value, [message])
.true(value, [message])
.false(value, [message])
.is(value, expected, [message])
.not(value, expected, [message])
.deepEqual(value, expected, [message])
.notDeepEqual(value, expected, [message])
.deepEqual()ã€‚
.throws(fn, [expected, [message]])
.throwsAsync(thrower, [expected, [message]])
.notThrows(fn, [message])
.notThrowsAsync(nonThrower, [message])
.regex(contents, regex, [message])
.notRegex(contents, regex, [message])
.snapshot(expected, [message])
.snapshot(expected, [options], [message])
```

### å®‰è£…

æƒ…æ™¯ä¸€ï¼ˆæ¨èï¼‰ï¼šæµ‹è¯•avaæ­£å¸¸å®‰è£…ï¼Œ`npx ava --version`

```bash
npm init -y
npm install -D ava // npm
yarn add ava -D // yarn
```

æƒ…æ™¯äºŒï¼š

```bash
// åˆ›å»ºä¸€ä¸ªavaé¡¹ç›®
npm init ava
// å½¢æˆpackage.jsonæ–‡ä»¶
{
	"name": "ava-project", 
	"scripts": {
		"test": "ava"
	},
	"devDependencies": {
		"ava": "^1.0.0"
	}
}
```

### æµ‹è¯•æ¡ˆä¾‹

![image-20230913115624792](README.assets/image-20230913115624792.png)

æµç¨‹ï¼šå¼•ç”¨avaçš„æµ‹è¯•APIã€æ‰§è¡Œæµ‹è¯•ï¼ˆ`npm run test`æˆ–`npx ava`æˆ–`npx ava test.js`ï¼‰ã€ä½¿ç”¨æ–­è¨€ã€‚

```js
// test.jsæ–‡ä»¶ï¼š
import test from 'ava';
const testfn = (a, b) => a + b
const testfnPromise = (a, b) => {
  return new Promise((resolve) => {
    setTimeout(() => {
      resolve(a + b)
    }, 2000)
  })
}
test('hello ava', t => {
  t.pass()
})
test('my first test of ava assertion', async t => {
  const str = 'hello ava!!!!'
  t.is(str, 'hello ava!!!!')
});
test('add method test', async t => {
  const result = testfn(3, 4)
  t.is(result, 7)
})
// å¼‚æ­¥ç›¸å…³
// å¦‚æœå¼‚æ­¥æ“ä½œä½¿ç”¨promiseï¼Œåˆ™åº”è¿”å›promiseï¼š
// test('fetches foo', t => {
// 	return fetch().then(data => {
// 		t.is(data, 'foo');
// 	});
// });
// ä¹Ÿå¯ä»¥ä½¿ç”¨async/awaitï¼š
test.failing('add method testPromise', async t => {
  const result = await testfnPromise(3, 4)
  t.is(result, 7)
})
```

```js
// assertion.test.jsæ–‡ä»¶ï¼š
import test from 'ava';
test('pass assertion', async t => {
  t.pass(); // å‘Šè¯‰å½“å‰æµ‹è¯•é€šè¿‡äº†æµ‹è¯•
});
test('fail assertion', async t => {
  t.is.skip() // è·³è¿‡å½“å‰æµ‹è¯•ï¼Œé¿å¼€é”™è¯¯ï¼ˆt.fail()ï¼‰
})
test('assert test', async t => {
  t.assert(true, 'assert function , assert assertion') // å¦‚æœç¬¬ä¸€ä¸ªå‚æ•°ä¸ºfalseï¼Œåˆ™æµ‹è¯•ä¸é€šè¿‡
})
test('not test', async t => {
  t.not(1, 2) // ä¸isæ–¹æ³•ç›¸åï¼ŒæœŸæœ›å‰é¢çš„å€¼ä¸åé¢çš„å€¼ä¸ç›¸ç­‰
})
test('regex test', async t => {
  t.regex('jsx', new RegExp('js')) // æ­£åˆ™åŒ¹é…
})
test('throws fn test', async t => {
  t.throws(() => {
    throw new TypeError('type error in ava')
  }, TypeError)
})
const fn = () => {
  throw new TypeError('ğŸ¦„');
};
test('throws', t => {
  const error = t.throws(() => {
    fn();
  }, TypeError);
  console.log(error.message)
  t.is(error.message, 'ğŸ¦„');
});
```

<img src="README.assets/image-20230913124905948.png" alt="image-20230913124905948" style="zoom:80%;" />

### CLIå‘½ä»¤

ä½¿ç”¨`--help`å‘½ä»¤æŸ¥çœ‹avaæ”¯æŒçš„cliå‚æ•°

```bash
âœ npx ava --help

  Testing can be a drag. AVA helps you get it done.

  Usage
    ava [<file> ...]

  Options
    --watch, -w             Re-run tests when tests and source files change
    --match, -m             Only run tests with matching title (Can be repeated)
    --update-snapshots, -u  Update snapshots
    // `--fail-fast`ï¼Œé‡åˆ°å¤±è´¥ä¹‹ååˆ™è¿›è¡Œåœæ­¢ï¼Œä¸ç”¨ç­‰åˆ°æ‰€æœ‰æµ‹è¯•ç”¨ä¾‹å…¨éƒ¨æ‰§è¡Œå®Œã€‚
    --fail-fast             Stop after first test failure
    --timeout, -T           Set global timeout (milliseconds or human-readable, e.g. 10s, 2m)
    --serial, -s            Run tests serially
    --concurrency, -c       Max number of test files running at the same time (Default: CPU cores)
    --verbose, -v           Enable verbose output
    --tap, -t               Generate TAP output
    --color                 Force color output
    --no-color              Disable color output
    --reset-cache           Reset AVA's compilation cache and exit
    --config                JavaScript file for AVA to read its config from, instead of using package.json
                            or ava.config.js files

  Examples
    ava
    ava test.js test2.js
    ava test-*.js
    ava test

  The above relies on your shell expanding the glob patterns.
  Without arguments, AVA uses the following patterns:
    **/test.js **/test-*.js **/*.spec.js **/*.test.js **/test/**/*.js **/tests/**/*.js **/__tests__/**/*.js
```

#### æ–‡ä»¶åŒ¹é…

**avaä¼šè‡ªåŠ¨æœç´¢å¦‚ä¸‹æ–‡ä»¶ç»“å°¾çš„æ–‡ä»¶ï¼š**`**/test.js`ã€`**/test-*.js`ã€`**/*.spec.js`ã€`**/*.test.js`ã€`**/test/**/*.js`ã€`**/tests/**/*.js`ã€`**/__tests__/**/*.js`ã€‚

**å¯ä»¥ä½¿ç”¨`match`æŒ‡ä»¤ï¼ŒåŒ¹é…å¯¹åº”éœ€è¦æµ‹è¯•çš„æ–‡ä»¶ï¼š**

åŒ¹é…æ ‡é¢˜ä»¥`foo`ç»“å°¾ï¼š`npx ava --match ='* foo'`ï¼›

åŒ¹é…æ ‡é¢˜ä»¥`foo`å¼€å¤´ï¼š`npx ava --match ='foo *'`ï¼›

åŒ¹é…æ ‡é¢˜åŒ…å«`foo`ï¼š`npx ava --match ='* foo *'`ï¼›

åŒ¹é…æ˜¯å®Œå…¨ç›¸åŒ `foo`ï¼š`npx ava --match ='foo'`ï¼›

åŒ¹é…æ ‡é¢˜ä¸åŒ…å«`foo`ï¼š`npx ava --match ='ï¼* foo *'`ï¼›

åŒ¹é…ä»¥`foo`å¼€å¤´å’Œä»¥`bar`ç»“å°¾çš„æ ‡é¢˜ï¼š`npx ava --match ='foo * bar'`ï¼›

åŒ¹é…ä»¥`foo`å¼€å¤´æˆ–ä»¥`bar`ç»“å°¾çš„æ ‡é¢˜ï¼š`npx ava --match ='foo *' -  match ='* bar'`ï¼›

#### reporter

é»˜è®¤æƒ…å†µä¸‹ï¼ŒAVAä½¿ç”¨æœ€å°çš„æŠ¥å‘Šï¼š

<img src="README.assets/mini-reporter.gif" alt="img" style="zoom: 50%;" />

ä½¿ç”¨`--verbose`æ ‡å¿—åˆ™å¯ç”¨è¯¦ç»†çš„æŠ¥å‘Šè€…ï¼ˆé™¤éå¯ç”¨TAPæŠ¥å‘Šï¼Œå¦åˆ™å§‹ç»ˆåœ¨CIç¯å¢ƒä¸­ä½¿ç”¨æ­¤é€‰é¡¹ï¼‰ã€‚

<img src="README.assets/image-20230913115801686.png" alt="image-20230913115801686" style="zoom:80%;" />

**TAPæŠ¥å‘Šï¼ˆæ¨èï¼‰ï¼š**AVAæ”¯æŒTAPæ ¼å¼ï¼Œå› æ­¤ä¸ä»»ä½•TAPæŠ¥å‘Šå™¨å…¼å®¹ï¼Œä½¿ç”¨`--tap`æ ‡å¿—åˆ™å¯ç”¨TAPè¾“å‡ºï¼Œ`npx ava --tap | npx tap-nyan`ã€‚ä¸€äº›æ ¼å¼ï¼š[tap-dot](https://github.com/scottcorgan/tap-dot) - Dotted outputã€[tap-spec](https://github.com/scottcorgan/tap-spec) - Mocha-like spec reporterã€[tap-nyan](https://github.com/calvinmetcalf/tap-nyan) - Nyan catã€[tap-min](https://github.com/gummesson/tap-min) - Minimal outputã€[tap-difflet](https://github.com/namuol/tap-difflet) - Minimal output with diffingã€[tap-diff](https://github.com/axross/tap-diff) - Human-friendly output with diffingã€[tap-simple](https://github.com/joeybaker/tap-simple) - Simple outputã€[faucet](https://github.com/substack/faucet) - Human-readable summarizerã€[tap-mocha-reporter](https://github.com/isaacs/tap-mocha-reporter) - Use any of the [Mocha reporters](https://github.com/isaacs/tap-mocha-reporter/tree/master/lib/reporters)ã€[tap-summary](https://github.com/zoubin/tap-summary) - Summarized outputã€[tap-pessimist](https://github.com/clux/tap-pessimist) - Only shows failed testsã€[tap-prettify](https://github.com/toolness/tap-prettify) - Nice readable output with diffingã€[tap-colorize](https://github.com/substack/tap-colorize) - Colorize the output while preserving machine-readabilityã€[tap-bail](https://github.com/juliangruber/tap-bail) - Bail out when the first test failsã€[tap-notify](https://github.com/axross/tap-notify) - Notifier for macOS, Linux and Windowsã€[tap-json](https://github.com/gummesson/tap-json) - JSON outputã€[ava-tap-json](https://github.com/yovasx2/ava-tap-json) - JSON output with AVA compatibilityã€[tap-xunit](https://github.com/aghassemi/tap-xunit) - xUnit outputã€[tap-teamcity](https://github.com/smockle/tap-teamcity) - Output for TeamCityã€‚

<img src="README.assets/image-20230913125312143.png" alt="image-20230913125312143" style="zoom: 80%;" />

<img src="README.assets/image-20230913125527658.png" alt="image-20230913125527658" style="zoom:80%;" />

<img src="README.assets/image-20230913125532939.png" alt="image-20230913125532939" style="zoom:80%;" />

#### å¿«ç…§åŠŸèƒ½

æ›´æ–°å¿«ç…§å¯ä½¿ç”¨`ava --update-snapshots`ã€‚avaè‡ªåŠ¨è¿›è¡Œé¡¹ç›®æµ‹è¯•å¿«ç…§ã€‚å¦‚æœæ–‡ä»¶æ”¾ç½®åœ¨`test`æˆ–è€…`tests`ç›®å½•ï¼Œåˆ™å¿«ç…§ä¼šæ”¾ç½®åœ¨`snapshots`ç›®å½•ï¼›å¦‚æœæµ‹è¯•æ”¾ç½®åœ¨`__test__`ç›®å½•ï¼Œåˆ™å¿«ç…§æ”¾ç½®åœ¨`__snapshots__`ç›®å½•ã€‚å¯ä»¥æŒ‡å®šä¸€ä¸ªå›ºå®šä½ç½®ï¼Œåœ¨`package.json`é…ç½®ä¸­æŒ‡å®šå­˜å‚¨å¿«ç…§æ–‡ä»¶çš„ä½ç½®ï¼š

**package.jsonï¼š**

```json
{
	 "ava"ï¼š{
		 "snapshotDir"ï¼š"è‡ªå®šä¹‰ç›®å½•"
	}
}
```

#### è®¾ç½®è¶…æ—¶

AVAä¸­çš„è¶…æ—¶è¡Œä¸ºä¸å…¶å®ƒæµ‹è¯•æ¡†æ¶ä¸­çš„è¡Œä¸ºä¸åŒï¼ŒAVAæ²¡æœ‰é»˜è®¤è¶…æ—¶ï¼Œä¸”åœ¨æ¯æ¬¡æµ‹è¯•åä¼šé‡ç½®è®¡æ—¶å™¨ï¼Œå¦‚æœåœ¨æŒ‡å®šçš„è¶…æ—¶å†…æ²¡æœ‰æ”¶åˆ°æ–°çš„æµ‹è¯•ç»“æœï¼Œåˆ™å¼ºåˆ¶æµ‹è¯•é€€å‡ºï¼Œè¿™å¯ç”¨äºå¤„ç†åœæ»çš„æµ‹è¯•ã€‚

å¯ä»¥ä½¿ç”¨è¶…æ—¶`--timeout` å‘½ä»¤è¡Œé€‰é¡¹é…ç½®ï¼ˆæˆ–åœ¨é…ç½®æ–‡ä»¶ä¸­è®¾ç½®ï¼‰ï¼šå¦‚10ç§’æ˜¯`npx ava --timeout = 10s `ï¼Œ2åˆ†é’Ÿæ˜¯`npx ava --timeout = 2m `ï¼Œ100æ¯«ç§’æ˜¯`npx ava --timeout = 100`ã€‚

å¯ä»¥ä¸ºæ¯ä¸ªæµ‹è¯•å•ç‹¬è®¾ç½®è¶…æ—¶ï¼Œæ¯æ¬¡è¿›è¡Œæ–­è¨€æ—¶éƒ½ä¼šé‡ç½®è¿™äº›è¶…æ—¶ï¼š

```js
test('foo', t => {
	t.timeout(100); // 100 milliseconds
	// Write your assertions here
});
```

### é…ç½®æ–‡ä»¶

```json
{
	"ava": {
		"files": [
			"test/**/*",
			"!test/exclude-files-in-this-directory",
			"!**/exclude-files-with-this-name.*"
		],
		"helpers": [
			"**/helpers/**/*"
		],
		"sources": [
			"src/**/*"
		],
		"match": [
			"*oo",
			"!foo"
		],
		"cache": true,
		"concurrency": 5,
		"failFast": true,
		"failWithoutAssertions": false,
		"environmentVariables": {
			"MY_ENVIRONMENT_VARIABLE": "some value"
		},
		"tap": true,
		"verbose": true,
		"compileEnhancements": false,
		"require": [
			"@babel/register"
		],
		"babel": {
			"extensions": ["js", "jsx"],
			"testOptions": {
				"babelrc": false
			}
		}
	}
}
```

- `files`ï¼šç”¨äºé€‰æ‹©æµ‹è¯•æ–‡ä»¶çš„globæ¨¡å¼æ•°ç»„ï¼ˆå¸¦æœ‰ä¸‹åˆ’çº¿å‰ç¼€çš„æ–‡ä»¶å°†è¢«å¿½ç•¥ï¼‰ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œä»…é€‰æ‹©å…·æœ‰`js`æ‰©å±•åçš„æ–‡ä»¶ï¼ˆå³ä½¿è¯¥æ¨¡å¼ä¸å…¶ä»–æ–‡ä»¶åŒ¹é…ï¼‰ï¼Œè€ŒæŒ‡å®š`extensions`å¹¶`babel.extensions`åˆ™å…è®¸å…¶å®ƒæ–‡ä»¶æ‰©å±•åã€‚æ³¨æ„ï¼Œåœ¨CLIä¸Šæä¾›æ–‡ä»¶ä¼šè¦†ç›–è¯¥`files`é€‰é¡¹ã€‚

- `helpers`ï¼šç”¨äºé€‰æ‹©å¸®åŠ©æ–‡ä»¶çš„globæ¨¡å¼æ•°ç»„ï¼Œè¿™é‡ŒåŒ¹é…çš„æ–‡ä»¶æ°¸è¿œä¸ä¼šè¢«è§†ä¸ºæµ‹è¯•ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œä»…é€‰æ‹©å…·æœ‰`js`æ‰©å±•åçš„æ–‡ä»¶ï¼Œå³ä½¿è¯¥æ¨¡å¼ä¸å…¶å®ƒæ–‡ä»¶åŒ¹é…ï¼Œè€ŒæŒ‡å®š`extensions`å¹¶`babel.extensions`å…è®¸å…¶ä»–æ–‡ä»¶æ‰©å±•åã€‚

- `sources`ï¼šä¸€ç»„globæ¨¡å¼ï¼Œç”¨äºåŒ¹é…æ–‡ä»¶ï¼Œè¿™äº›æ–‡ä»¶åœ¨æ›´æ”¹æ—¶ä¼šå¯¼è‡´é‡æ–°è¿è¡Œæµ‹è¯•ï¼ˆåœ¨ç›‘è§†æ¨¡å¼ä¸‹ï¼‰ã€‚æœ‰å…³è¯¦ç»†ä¿¡æ¯ï¼Œ[è¯·å‚é˜…](https://github.com/avajs/ava/blob/master/docs/recipes/watch-mode.md#source-files-and-test-files)ã€‚

- `match`ï¼šé€šå¸¸åœ¨`package.json`é…ç½®ä¸­æ²¡ç”¨ï¼Œä½†ç­‰åŒäºåœ¨CLIä¸ŠæŒ‡å®š`--match`ã€‚

- `cache`ï¼šç¼“å­˜ç¼–è¯‘çš„æµ‹è¯•å’Œå¸®åŠ©æ–‡ä»¶`node_modules/.cache/ava`ã€‚å¦‚æœ`false`ï¼Œåˆ™æ–‡ä»¶ç¼“å­˜åœ¨ä¸´æ—¶ç›®å½•ä¸­ã€‚

- `failFast`ï¼šä¸€æ—¦æµ‹è¯•å¤±è´¥ï¼Œåœæ­¢è¿è¡Œè¿›ä¸€æ­¥çš„æµ‹è¯•ã€‚

- `failWithoutAssertions`ï¼šå¦‚æœè®¾ç½®æˆ`false`ï¼Œé‚£ä¹ˆå¦‚æœæ²¡æœ‰è¿è¡Œæ–­è¨€ï¼Œåˆ™æµ‹è¯•å¤±è´¥ã€‚
- `environmentVariables`ï¼šæŒ‡å®šè¦ä¾›æµ‹è¯•ä½¿ç”¨çš„ç¯å¢ƒå˜é‡ï¼Œæ­¤å¤„å®šä¹‰çš„ç¯å¢ƒå˜é‡ä¼šè¦†ç›–å…¶ä¸­çš„ç¯å¢ƒå˜é‡`process.env`ã€‚
- `tap`ï¼šè®¾ç½®æˆ `true`ï¼Œå¯ç”¨TAPæŠ¥å‘Šã€‚
- `verbose`ï¼šè®¾ç½®æˆ `true`ï¼Œå¯ç”¨è¯¦ç»†è¾“å‡ºã€‚
- `snapshotDir`ï¼šæŒ‡å®šç”¨äºå­˜å‚¨å¿«ç…§æ–‡ä»¶çš„å›ºå®šä½ç½®ã€‚å¦‚æœå¿«ç…§æœ€ç»ˆä½äºé”™è¯¯çš„ä½ç½®ï¼Œè¯·ä½¿ç”¨æ­¤é€‰é¡¹ã€‚
- `compileEnhancements`ï¼šè®¾ç½®æˆ `false`ï¼Œç¦ç”¨äº† [`power-assert`](https://github.com/avajs/ava/blob/master/docs/03-assertions.md#enhanced-assertion-messages)ï¼Œå¦åˆ™æœ‰åŠ©äºæä¾›æ›´å…·æè¿°æ€§çš„é”™è¯¯æ¶ˆæ¯ï¼Œå¹¶æ£€æµ‹`t.throws()`æ–­è¨€çš„ä¸å½“ä½¿ç”¨ã€‚
- `extensions`ï¼šæœªä½¿ç”¨AVAçš„Babelé¢„è®¾è¿›è¡Œé¢„ç¼–è¯‘çš„æµ‹è¯•æ–‡ä»¶çš„æ‰©å±•åã€‚è¯·æ³¨æ„ï¼Œæ–‡ä»¶ä»ç„¶ä¼šè¢«ç¼–è¯‘ä¸ºå¯ç”¨`power-assert`å’Œå…¶å®ƒåŠŸèƒ½ï¼Œå› æ­¤å¯èƒ½è¿˜éœ€è¦è®¾ç½®`compileEnhancements`ä¸º`false`æ–‡ä»¶æ˜¯å¦ä¸ºæœ‰æ•ˆçš„JavaScriptã€‚è®¾ç½®æ­¤`"js"`å€¼ä¼šè¦†ç›–é»˜è®¤å€¼ï¼Œå› æ­¤è¯·ç¡®ä¿åœ¨åˆ—è¡¨ä¸­åŒ…å«è¯¥æ‰©å±•åï¼Œåªè¦å®ƒä¸åŒ…å«åœ¨`babel.extensions`å†…ã€‚
- `require`ï¼šåœ¨è¿è¡Œæµ‹è¯•ä¹‹å‰éœ€è¦é¢å¤–çš„æ¨¡å—ï¼Œå·¥ä½œè¿›ç¨‹ä¸­éœ€è¦æ¨¡å—ã€‚
- `babel`ï¼šæµ‹è¯•æ–‡ä»¶ç‰¹å®šçš„Babelé€‰é¡¹ã€‚æœ‰å…³è¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚é˜…[Babelé…ç½®](https://github.com/avajs/ava/blob/master/docs/recipes/babel.md#configuring-babel)ã€‚
- `babel.extensions`ï¼šå°†ä½¿ç”¨AVAçš„Babelé¢„è®¾è¿›è¡Œé¢„ç¼–è¯‘çš„æµ‹è¯•æ–‡ä»¶çš„æ‰©å±•ï¼Œè®¾ç½®æ­¤é€‰é¡¹ä¼šè¦†ç›–é»˜è®¤`"js"`å€¼ï¼Œå› æ­¤è¯·ç¡®ä¿åœ¨åˆ—è¡¨ä¸­åŒ…å«è¯¥æ‰©å±•åã€‚
- `timeout`ï¼šAVAä¸­çš„è¶…æ—¶è¡Œä¸ºä¸å…¶å®ƒæµ‹è¯•æ¡†æ¶ä¸­çš„è¡Œä¸ºä¸åŒï¼ŒAVAåœ¨æ¯æ¬¡æµ‹è¯•åé‡ç½®è®¡æ—¶å™¨ï¼Œå¦‚æœåœ¨æŒ‡å®šçš„è¶…æ—¶å†…æ²¡æœ‰æ”¶åˆ°æ–°çš„æµ‹è¯•ç»“æœï¼Œåˆ™å¼ºåˆ¶æµ‹è¯•é€€å‡ºã€‚è¿™å¯ç”¨äºå¤„ç†åœæ»çš„æµ‹è¯•ã€‚è¯·å‚é˜…æˆ‘ä»¬çš„[è¶…æ—¶æ–‡æ¡£](https://github.com/avajs/ava/blob/master/docs/07-test-timeouts.md)ä»¥è·å–æ›´å¤šé€‰

### avaè®¾ç½®ESLint

å¦‚æœä½¿ç”¨äº†ESLintï¼Œåˆ™è¦åœ¨eslinté…ç½®æ–‡ä»¶é‡Œæ·»åŠ [eslint-plugin-ava](https://github.com/avajs/eslint-plugin-ava)æ’ä»¶ï¼š

```json
{
	plugins: [
		"ava"
	]
}
```



## Karma

æµ‹è¯•ç¯å¢ƒä¸å¸®æ‰‹Karmaï¼šä¸€ä¸ªåŸºäº Node.js çš„ JavaScript æµ‹è¯•æ‰§è¡Œè¿‡ç¨‹ç®¡ç†å·¥å…·ï¼ˆTest Runnerï¼Œè¿è¡Œç¯å¢ƒï¼‰ï¼Œå¯ä»¥ååŠ©CIå·¥å…·æˆ–å…¶å®ƒæ¡†æ¶æŠŠæµè§ˆå™¨çš„ç¯å¢ƒåº”ç”¨åˆ°æµ‹è¯•ç”¨ä¾‹ä¸Šã€‚Karmaå¯ç”¨äºæµ‹è¯•æ‰€æœ‰ä¸»æµ Web æµè§ˆå™¨ï¼Œä¹Ÿå¯ä»¥é›†æˆåˆ° CIï¼ˆContinuous integrationï¼‰å·¥å…·ï¼Œè¿˜å¯ä»¥å’Œå…¶å®ƒä»£ç ç¼–è¾‘å™¨æˆ–æµ‹è¯•æ¡†æ¶ä¸€èµ·ä½¿ç”¨ã€‚

Karma ä¼šç›‘æ§é…ç½®æ–‡ä»¶ä¸­æ‰€æŒ‡å®šçš„æ¯ä¸€ä¸ªæ–‡ä»¶ï¼Œæ¯å½“æ–‡ä»¶å‘ç”Ÿæ”¹å˜ï¼Œå®ƒéƒ½ä¼šå‘æµ‹è¯•æœåŠ¡å™¨å‘é€ä¿¡å·ï¼Œæ¥é€šçŸ¥æ‰€æœ‰çš„æµè§ˆå™¨å†æ¬¡è¿è¡Œæµ‹è¯•ä»£ç ï¼Œæ­¤æ—¶æµè§ˆå™¨ä¼šé‡æ–°åŠ è½½æºæ–‡ä»¶ï¼Œå¹¶æ‰§è¡Œæµ‹è¯•ä»£ç ï¼Œå…¶ç»“æœä¼šä¼ é€’å›æœåŠ¡å™¨ï¼Œå¹¶ä»¥æŸç§å½¢å¼æ˜¾ç¤ºç»™å¼€å‘è€…ã€‚

è®¿é—®æµè§ˆå™¨æ‰§è¡Œç»“æœï¼Œå¯é€šè¿‡ä»¥ä¸‹çš„æ–¹å¼ï¼šâ‘ æ‰‹å·¥æ–¹å¼ï¼Œç›´æ¥é€šè¿‡æµè§ˆå™¨åˆ·æ–°ï¼›â‘¡è‡ªåŠ¨æ–¹å¼ï¼Œè®© karma æ¥å¯åŠ¨å¯¹åº”çš„æµè§ˆå™¨ã€‚

### å·¥ä½œåŸç†

`karma` æ˜¯ä¸€ä¸ªå…¸å‹çš„ `C/S` ç¨‹åºï¼ŒåŒ…å« client å’Œ server ï¼Œé€šè®¯æ–¹å¼åŸºäº `Http`ã€‚é€šå¸¸æƒ…å†µä¸‹ï¼Œå®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯åŸºæœ¬éƒ½è¿è¡Œåœ¨å¼€å‘è€…æœ¬åœ°æœºå™¨ä¸Šï¼Œä¸€ä¸ªæœåŠ¡ç«¯å®ä¾‹å¯¹åº”ä¸€ä¸ªé¡¹ç›®ï¼ˆå¦‚æœè¦è¿è¡Œå¤šä¸ªé¡¹ç›®ï¼Œåˆ™è¦åŒæ—¶å¼€å¯å¤šä¸ªæœåŠ¡ç«¯å®ä¾‹ï¼‰ã€‚

**Server**ï¼šæ¡†æ¶çš„ä¸»è¦ç»„æˆéƒ¨åˆ†ä¹‹ä¸€ï¼Œå®ƒå†…éƒ¨ä¿å­˜äº†æ‰€æœ‰çš„ç¨‹åºè¿è¡ŒçŠ¶æ€ï¼ˆå¦‚ client è¿æ¥ã€å½“å‰è¿è¡Œçš„å•æµ‹æ–‡ä»¶ï¼‰ï¼Œæ ¹æ®è¿™äº›æ•°æ®çŠ¶æ€è€Œæä¾›çš„åŠŸèƒ½æœ‰ï¼šâ‘ `FS Watcher`ï¼šç”¨äºç›‘è§†æ–‡ä»¶ç³»ç»Ÿï¼ˆFile Systemï¼‰çš„æ–‡ä»¶çš„å˜åŒ–ï¼›â‘¡`Manager`ç®¡ç†ç»ˆç«¯ï¼šä¸ client è¿›è¡Œé€šè®¯ï¼›â‘¢`Reporter`ï¼šå‘å¼€å‘è€…è¾“å‡ºæµ‹è¯•ç»“æœï¼›â‘£`Web Server`ï¼šæä¾› client ç«¯æ‰€éœ€çš„èµ„æºæ–‡ä»¶ç­‰ã€‚

server ç«¯ä¼šå‘é€è¿™äº›æ¶ˆæ¯ï¼š

![karma_impl_client_message_s](README.assets/TB1PvisLXXXXXcqaXXXEHlCNpXX-896-103.png)

![karma_server](README.assets/TB13X9xLXXXXXXoaXXXDUoU9pXX-902-329.png)

**Client**ï¼šå•æµ‹æœ€ç»ˆè¿è¡Œçš„åœ°æ–¹ï¼ˆç±»ä¼¼ä¸€ä¸ªweb appï¼‰ï¼Œä¸serverç«¯åˆ©ç”¨`socket.io`è¿›è¡Œé€šè®¯ï¼Œ è€Œå•æµ‹æ˜¯æ‰§è¡Œåœ¨ä¸€ä¸ªç‹¬ç«‹çš„ `iframe` ä¸­ã€‚å…¶ä¸­ï¼Œ`Adapter`ä¸ºé€‚é…å™¨ï¼Œå°†Clientä¸å…¶å®ƒæµ‹è¯•æ¡†æ¶è¿›è¡Œå¯¹æ¥ï¼›`Testing Framework`ä»£è¡¨å…¶å®ƒçš„ä¸€äº›æµ‹è¯•æ¡†æ¶ï¼Œå¯ä»¥æ˜¯ç¬¬ä¸‰æ–¹çš„ã€‚

client ç«¯ä¼šå‘é€è¿™äº›æ¶ˆæ¯ï¼š

![karma_impl_client_message_c](README.assets/TB1XXuILXXXXXcAXFXX.hdJKpXX-918-179.png)

<img src="README.assets/TB1jTKwLXXXXXX.aXXX0KhCSFXX-619-472.png" alt="karma_impl_client" style="zoom:80%;" />

### å®‰è£…

å¯¹äºNodejsç‰ˆæœ¬çš„è¦æ±‚ï¼šKarma currently works on Node.js **6.x**, **8.x**, and **10.x**. See [FAQ](https://karma-runner.github.io/4.0/intro/faq.html) for more info.

å…¨å±€å®‰è£…ï¼š`npm install -g karma`ã€‚ä½¿ç”¨æ–¹å¼ï¼šå¯ä»¥åœ¨ä»»ä½•ä½ç½®ç›´æ¥è¿è¡Œ karma å‘½ä»¤ã€‚

æœ¬åœ°å®‰è£…ï¼ˆæ¨èï¼Œå› ä¸ºæœ‰æ—¶å€™éœ€è¦åœ¨ç‰¹å®šçš„ç‰ˆæœ¬ä¸‹æ‰§è¡Œä¾èµ–ï¼Œä»¥åŠåšä¸€äº›é¡¹ç›®å±‚çº§çš„å‡çº§æ“ä½œï¼Œè€Œå…¨å±€å®‰è£…å¯èƒ½ä¼šå¯¼è‡´ä¸åŒé¡¹ç›®çš„å…¼å®¹æ€§é”™è¯¯ï¼‰ï¼š`npm install karma --save-dev`ã€‚ä½¿ç”¨æ–¹å¼ï¼šâ‘ `./node_modules/.bin/karma`ï¼›â‘¡`npx karma --version`ã€‚

å¦‚æœå®‰è£… `karma-cli`ï¼ˆ`npm install -g karma-cli`ï¼‰ï¼Œåˆ™å®ƒå°±ä¼šåœ¨å½“å‰ç›®å½•ä¸‹å¯»æ‰¾ karma çš„å¯æ‰§è¡Œæ–‡ä»¶ï¼Œè¿™æ ·å°±å¯åœ¨ä¸€ä¸ªç³»ç»Ÿå†…è¿è¡Œå¤šä¸ªç‰ˆæœ¬çš„Karmaã€‚

### é…ç½®æ–‡ä»¶

karmaé…ç½®æ–‡ä»¶å¯ä»¥ç”¨JavaScriptï¼ŒCoffeeScriptæˆ–TypeScriptç¼–å†™ï¼Œå¹¶ä½œä¸ºå¸¸è§„çš„Node.jsæ¨¡å—åŠ è½½ã€‚é™¤éä½œä¸ºå‚æ•°æä¾›ï¼Œå¦åˆ™Karma CLIå°†ä»¥å¦‚ä¸‹é¡ºåºæŸ¥æ‰¾é…ç½®æ–‡ä»¶ï¼ˆä»å·¦è‡³å³ï¼‰ï¼š `./karma.conf.js` ã€ `./karma.conf.coffee` ã€ `./karma.conf.ts` ã€ `./.config/karma.conf.js` ã€ `./.config/karma.conf.coffee` ã€ `./.config/karma.conf.ts`ã€‚åœ¨é…ç½®æ–‡ä»¶ä¸­ï¼Œé…ç½®ä»£ç é€šè¿‡è®¾ç½®`module.exports`æŒ‡å‘ä¸€ä¸ªæ¥å—ä¸€ä¸ªå‚æ•°çš„å‡½æ•°ï¼ˆé…ç½®å¯¹è±¡ï¼‰ï¼Œè€Œé…ç½®æ–‡ä»¶ä¸­çš„åŸºæœ¬çš„å±æ€§ä»‹ç»åœ¨[Overview](https://karma-runner.github.io/4.0/config/configuration-file.html)ã€‚

```javascript
// karma.conf.js
module.exports = function(config) {
  config.set({
    basePath: '../..',
    frameworks: ['jasmine'],
    //...
  });
};

# karma.conf.coffee
module.exports = (config) ->
  config.set
    basePath: '../..'
    frameworks: ['jasmine']
    # ...

// karma.conf.tsã€‚å…³äºtypescriptçš„æ”¯æŒï¼Œéœ€è¦ä½¿ç”¨åˆ°`ts-node`ï¼Œé…ç½®ts-nodeä»¥ä½¿ç”¨`commonjs`æ¨¡å—æ ¼ã€‚
module.exports = (config) => {
  config.set({
    basePath: '../..',
    frameworks: ['jasmine'],
    //...
  });
}
```

å¯ä»¥ä½¿ç”¨CLIå·¥å…·ï¼Œå¿«é€Ÿåˆ›å»ºé…ç½®ï¼ˆ`npx karma init`ï¼‰ï¼š

```bash
~/Downloads/Demo is ğŸ“¦ v1.0.0 via â¬¢ v10.16.0 
âœ npx karma init

# å¦‚æœåœ¨åº”ç”¨ä¸­ç”¨åˆ°äº†å…¶å®ƒçš„æµ‹è¯•æ¡†æ¶ï¼Œé‚£å°±éœ€è¦å®‰è£…å®ƒä»¬æ‰€å¯¹åº”çš„æ’ä»¶ï¼Œå¹¶åœ¨é…ç½®æ–‡ä»¶ä¸­æ ‡æ³¨å®ƒä»¬ï¼ˆè¯¦è§ karma.conf.js ä¸­çš„ plugins é¡¹ï¼‰
Which testing framework do you want to use ?
Press tab to list possible options. Enter to move to the next question.
> jasmine
# mocha
# qunit
# nodeunit
# nunit

# Require.js æ˜¯å¼‚æ­¥åŠ è½½è§„èŒƒï¼ˆAMDï¼‰çš„å®ç°ï¼Œå¸¸è¢«ä½œä¸ºåŸºç¡€ä»£ç åº“ï¼Œåº”ç”¨åœ¨äº†å¾ˆå¤šçš„é¡¹ç›®ä¸æ¡†æ¶ä¹‹ä¸­ï¼ˆå¦‚Dojo, AngularJsç­‰ï¼‰
Do you want to use Require.js ?
This will add Require.js plugin.
Press tab to list possible options. Enter to move to the next question.
> no
# yes

# é€‰æ‹©éœ€è¦è¿è¡Œæµ‹è¯•ç”¨ä¾‹çš„æµè§ˆå™¨ã€‚æ³¨æ„ï¼Œå¿…é¡»ä¿è¯æ‰€å¯¹åº”çš„æµè§ˆå™¨æ’ä»¶å·²ç»å®‰è£…æˆåŠŸã€‚
Do you want to capture any browsers automatically ?
Press tab to list possible options. Enter empty string to move to the next question.
> Chrome
# ChromeHeadless
# ChromeCanary
# Firefox
# Safari
# PhantomJS
# Opera
# IE

# é€‰æ‹©æµ‹è¯•ç”¨ä¾‹æ‰€åœ¨çš„ç›®å½•ä½ç½®ã€‚Karma æ”¯æŒé€šé…ç¬¦çš„æ–¹å¼é…ç½®æ–‡ä»¶æˆ–ç›®å½•ï¼ˆå¦‚*.js, test/**/*.jsç­‰ï¼‰ã€‚å¦‚æœç›®å½•æˆ–æ–‡ä»¶ä½¿ç”¨ç›¸å¯¹ä½ç½®ï¼Œåˆ™æ­¤æ—¶çš„è·¯å¾„æ˜¯ç›¸å¯¹äºå½“å‰è¿è¡Œkarmaå‘½ä»¤æ—¶æ‰€åœ¨çš„ç›®å½•ã€‚
What is the location of your source and test files ?
You can use glob patterns, eg. "js/*.js" or "test/**/*Spec.js".
Enter empty string to move to the next question.
> src/*.js

# ç›®å½•ä¸­ä¸åŒ…æ‹¬çš„é‚£äº›æ–‡ä»¶ï¼ˆå³ä¾‹å¤–çš„æ–‡ä»¶ï¼Œä¸éœ€è¦è¢«Karmaç›‘ç®¡çš„æ–‡ä»¶ï¼‰ã€‚
Should any of the files included by the previous patterns be excluded ?
You can use glob patterns, eg. "**/*.swp".
Enter empty string to move to the next question.

# æ˜¯å¦éœ€è¦ Karma è‡ªåŠ¨ç›‘å¬æ–‡ä»¶ï¼Œä¸”æ–‡ä»¶ä¸€æ—¦è¢«ä¿®æ”¹ï¼Œå°±é‡æ–°è¿è¡Œæµ‹è¯•ç”¨ä¾‹ã€‚
Do you want Karma to watch all the files and run the tests on change ?
Press tab to list possible options.
> yes
```

ç”Ÿæˆäº†ä¸€ä¸ª`karma.conf.js`æ–‡ä»¶ï¼š

```js
// Karma configuration
// Generated on Wed Jul 10 2019 22:46:32 GMT+0800 (GMT+08:00)

module.exports = function(config) {
  config.set({

    // base path that will be used to resolve all patterns (eg. files, exclude)
    basePath: '',


    // frameworks to use
    // available frameworks: https://npmjs.org/browse/keyword/karma-adapter
    frameworks: ['mocha'],


    // list of files / patterns to load in the browser
    files: [
      'src/*js'
    ],


    // list of files / patterns to exclude
    exclude: [
    ],


    // preprocess matching files before serving them to the browser
    // available preprocessors: https://npmjs.org/browse/keyword/karma-preprocessor
    preprocessors: {
    },


    // test results reporter to use
    // possible values: 'dots', 'progress'
    // available reporters: https://npmjs.org/browse/keyword/karma-reporter
    reporters: ['progress'],


    // web server port
    port: 9876,


    // enable / disable colors in the output (reporters and logs)
    colors: true,


    // level of logging
    // possible values: config.LOG_DISABLE || config.LOG_ERROR || config.LOG_WARN || config.LOG_INFO || config.LOG_DEBUG
    logLevel: config.LOG_INFO,


    // enable / disable watching file and executing tests whenever any file changes
    autoWatch: true,


    // start these browsers
    // available browser launchers: https://npmjs.org/browse/keyword/karma-launcher
    browsers: ['Chrome'],


    // Continuous Integration mode
    // if true, Karma captures browsers, runs the tests and exits
    singleRun: false,

    // Concurrency level
    // how many browser should be started simultaneous
    concurrency: Infinity
  })
}
```

### æµ‹è¯•æ¡ˆä¾‹

<img src="README.assets/image-20230915013957185.png" alt="image-20230915013957185" style="zoom:80%;" />

Karmaå¯¹babelæ˜¯æ”¯æŒçš„ï¼Œå¯ä»¥é€‰æ‹©[karma-babel-preprocessor](https://github.com/babel/karma-babel-preprocessor)æ’ä»¶ï¼Œä½†æ˜¯ `babel and karma-babel-preprocessor only convert ES6 modules to CommonJS/AMD/SystemJS/UMD**ï¼ˆkarma-babel-preprocessorä¸æ”¯æŒCommonJSç­‰è¯­æ³•ï¼‰. If you choose CommonJS, you still need to resolve and concatenate CommonJS modules on your own**. We recommend **karma-browserify + babelify** or **webpack + babel-loader** in such cases.`ï¼Œè¿™é‡Œé€‰æ‹©webpackã€‚

â‘ å®‰è£…ä¾èµ–ï¼ˆè¿™é‡Œç»“åˆå¦ä¸€æµ‹è¯•æ¡†æ¶mochaï¼‰ï¼š`npm install @babel/core @babel/preset-env chai mocha webpack webpack-cli babel-loader -D`ï¼›

â‘¡å®‰è£…karmaçš„é€‚é…å™¨ï¼š`npm install karma-webpack karma-chrome-launcher karma-mocha karma-chai -D`ï¼›

â‘¢é…ç½®`karma.config.js`ï¼š

```js
// Karma configuration
// Generated on Thu Jul 11 2019 23:23:44 GMT+0800 (GMT+08:00)
module.exports = function (config) {
  config.set({
    // base path that will be used to resolve all patterns (eg. files, exclude)
    basePath: '',
    // frameworks to use
    // available frameworks: https://npmjs.org/browse/keyword/karma-adapter
    frameworks: ['mocha'],
    // list of files / patterns to load in the browser
    files: [
      'src/**/*.js', // è‡ªåŠ¨æ‰§è¡Œjsæ–‡ä»¶
      'test/**/*.js' // å¯¹æµ‹è¯•ç”¨ä¾‹è¿›è¡Œç›‘è§†å¹¶æ‰§è¡Œ
    ],
    ......
    // preprocess matching files before serving them to the browser
    // available preprocessors: https://npmjs.org/browse/keyword/karma-preprocessor
    preprocessors: {
      'src/**/*.js': ['webpack'],
      'test/**/*.js': ['webpack']
    },
    webpack: {
      mode: "none",
      node: {
        fs: 'empty' // è®¾ç½®ä¸ºemptyï¼Œå¦åˆ™åœ¨æµè§ˆå™¨ä¸Šè¿è¡Œæ—¶fsä¸å­˜åœ¨
      },
      module: {
        rules: [
          { test: /\.js?$/, loader: "babel-loader", options: { presets: ["@babel/env"] }, }
        ]
      }
    },
    .......
    plugins: [
      'karma-mocha',
      'karma-chai',
      'karma-chrome-launcher',
      'karma-webpack'
    ]
  })
}
```

â‘£ä¹¦å†™`src/index.js`å’Œæµ‹è¯•ç”¨ä¾‹`test/test.js`ï¼š

```js
// src/index.js
console.log('info from src')
```

```js
// test/test.js
import { describe } from "mocha";
import { expect } from 'chai'
describe('first karma test', () => {
  it('hello mocha and karma', () => {
    console.log('hello mocha')
    expect(true).to.be.equal(true)
  })
})
```

â‘¤å¼€å§‹æµ‹è¯•ï¼š`npx karma start`æˆ–`npm run karma`ï¼ˆæ³¨æ„è¦åœ¨package.jsonä¸­çš„`scripts`èŠ‚ç‚¹ä¸‹åŠ å…¥`"karma": "karma start"`è„šæœ¬ï¼‰ï¼Œæ­¤æ—¶ä¿®æ”¹åé‡æ–°ä¿å­˜ä¹Ÿä¼šè‡ªåŠ¨é‡æ–°ç¼–è¯‘ï¼›

<img src="README.assets/image-20230915013907839.png" alt="image-20230915013907839"  />




## Nightmare

<img src="README.assets/image-20230916195851056.png" alt="image-20230916195851056" style="zoom:80%;" />

UIæµ‹è¯•åˆ©å™¨Nightmareï¼šå®ƒæ˜¯[Segment](https://segment.com/)çš„é«˜çº§æµè§ˆå™¨è‡ªåŠ¨åŒ–åº“ï¼Œä½¿ç”¨çš„åº•å±‚æ¡†æ¶æ˜¯electronï¼Œä¸[PhantomJS](http://phantomjs.org/)ç±»ä¼¼ï¼Œä½†å¤§çº¦[å¿«ä¸¤å€](https://github.com/segmentio/nightmare/issues/484#issuecomment-184519591)ï¼Œä¸”æ›´ç°ä»£ï¼Œä¸å…¶å®ƒe2eæµ‹è¯•æ¡†æ¶ç›¸æ¯”æ›´è½»é‡ã€‚å…¶ä¸»è¦è´Ÿè´£çš„æ˜¯å¯¹æµè§ˆå™¨è¿›è¡Œæ“ä½œçš„å·¥ä½œï¼Œç›®æ ‡æ˜¯å…¬å¼€ä¸€äº›æ¨¡ä»¿ç”¨æˆ·æ“ä½œï¼ˆä¾‹å¦‚`goto`ï¼Œ`type`å’Œ`click`ï¼‰çš„ç®€å•æ–¹æ³•ï¼Œä½¿ç”¨å¯¹æ¯ä¸ªè„šæœ¬å—åŒæ­¥çš„APIï¼Œè€Œä¸æ˜¯æ·±å±‚åµŒå¥—çš„å›è°ƒã€‚å®ƒæœ€åˆçš„è®¾è®¡ç”¨äºåœ¨ç«™ç‚¹ä¹‹é—´è‡ªåŠ¨æ‰§è¡Œä»»åŠ¡ï¼Œä½†æœ€å¸¸ç”¨äºUIæµ‹è¯•å’Œçˆ¬ç½‘ã€‚

### å®‰è£…

åˆå§‹åŒ–é¡¹ç›®åè¿›è¡Œå®‰è£…ï¼š`npm install --save-dev nightmare`ï¼Œå¯ä½¿ç”¨æ·˜å®æºåŠ é€Ÿelectronçš„å®‰è£…ï¼š`export ELECTRON_MIRROR="https://npm.taobao.org/mirrors/electron/"`ã€‚

### é…åˆmochaæµ‹è¯• 

nightmareå¯ä»¥è¿›è¡Œç½‘é¡µçš„æŠ“å–ï¼Œé…åˆmochaï¼ˆå®‰è£…ï¼š`npm install --save-dev mocha`ï¼‰è¿›è¡Œé¡µé¢çš„æµ‹è¯•ï¼ˆ`npx mocha`æˆ–`npm run test`ï¼Œæ³¨æ„åè€…è¦åœ¨package.jsonä¸­çš„`scripts`èŠ‚ç‚¹ä¸‹åŠ å…¥`"test": "mocha"`è„šæœ¬ï¼‰ï¼Œè¿˜å¯ä»¥å®‰è£…ä¸€äº›æ–­è¨€åº“ï¼ˆå¦‚`chai`ï¼‰ã€‚

   ```js
// æµ‹è¯•ä¾‹å­ï¼štest/test.js
const Nightmare = require('nightmare')
const assert = require('assert') // nightmareçš„æ–­è¨€åº“ï¼Ÿ
describe('first mocha and nightmare test', () => {
    this.timeout('30s') // Recommended: 5s locally, 10s to remote server, 30s from airplane Â¯\_(ãƒ„)_/Â¯
    let nightmare = null
    beforeEach(() => {
        nightmare = new Nightmare()
    })
    it('should load nightmare', done => {
        nightmare.goto('https://www.baidu.com') // your actual testing urls will likely be `http://localhost:port/path`
            .end()
            .then(function (result) { done() })
            .catch(done)
    })
    it('should load nightmare', done => {
        const selector = 'em'
        nightmare.goto('https://www.baidu.com')
            .type('#kw', 'nightmare') // é€‰ä¸­idä¸ºkwçš„è¾“å…¥æ¡†ï¼Œè¾“å…¥nightmare
            .click('#su') // ç‚¹å‡»æœç´¢æŒ‰é’®
            .wait('em') // emæ ‡ç­¾å…ƒç´ 
            .evaluate(selector => { // é€šè¿‡selectoræ¥ç­›é€‰å…ƒç´ 
                return document.querySelector(selector).innerText // now we're executing inside the browser scope.
            }, selector) // <-- that's how you pass parameters from Node scope to browser scope
            .end()
            .then(function (result) {
                console.log(result)
                assert.equal(result, 'nightmare')
                done()
            })
            .catch(done)
    })
})
   ```

<img src="README.assets/image-20230917000728975.png" alt="image-20230917000728975" style="zoom:80%;" />

### APIä»‹ç»

<img src="README.assets/image-20230917005049702.png" alt="image-20230917005049702" style="zoom: 67%;" />

**â‘ nightmareçš„é…ç½®é¡¹ï¼š**ï¼ˆé…ç½®é“¾æ¥ï¼šhttps://github.com/segmentio/nightmare#nightmareoptionsï¼‰

```
waitTimeout (default: 30s)
gotoTimeout (default: 30s)
loadTimeout (default: infinite)
executionTimeout (default: 30s)
paths
switches
electronPath
dock
openDevTools
typeInterval (default: 100ms)
pollInterval (default: 250ms)
maxAuthRetries (default: 3)
certificateSubjectName
.engineVersions()
.useragent(useragent)
.authentication(user, password)
.authentication(user, password)
.halt(error, done)
```

**â‘¡é¡µé¢äº¤äº’ç›¸å…³ï¼š**ï¼ˆ[é…ç½®å‚è€ƒé“¾æ¥](https://github.com/segmentio/nightmare#interact-with-the-page)ï¼‰

```
.back()
.forward()
.refresh()
.click(selector)
.mousedown(selector)
.mouseup(selector)
.mouseover(selector)
.mouseout(selector)
.type(selector[, text])
.insert(selector[, text])
.check(selector)
.uncheck(selector)
.select(selector, option)
.scrollTo(top, left)
.viewport(width, height)
.inject(type, file)
.evaluate(fn[, arg1, arg2,...])
.wait(ms)
.wait(selector)
.wait(fn[, arg1, arg2,...])
.header(header, value)
```

**â‘¢é¡µé¢æå–ï¼ˆä¿¡æ¯ï¼‰ï¼š**ï¼ˆ[é…ç½®å‚è€ƒé“¾æ¥](https://github.com/segmentio/nightmare#extract-from-the-page)ï¼‰

```
.exists(selector)
.visible(selector)
.on(event, callback)
.once(event, callback)
.removeListener(event, callback)
.screenshot([path][, clip])
.html(path, saveType)
.pdf(path, options)
.title()
.url()
.path()
```



## å…¶å®ƒ

ç‰ˆæœ¬æ§åˆ¶ç®¡ç†å·¥å…·ï¼šSVNã€Gitã€‚Bugç®¡ç†å·¥å…·ï¼šç¦…é“ã€‚æŠ“åŒ…å’Œå®šä½é—®é¢˜ï¼šFiddlerã€‚æ¥å£æµ‹è¯•ï¼špostmanã€jmeterã€soapuiã€‚æ€§èƒ½å’Œå‹åŠ›æµ‹è¯•ï¼šLoadrunnerã€Jmeterã€‚

2019å¹´Javascriptæµ‹è¯•æ¦‚è§ˆï¼šhttps://medium.com/welldone-software/an-overview-of-javascript-testing-in-2019-264e19514d0aï¼›
2018å¹´çš„è¯‘æ–‡ï¼ˆåœ¨æ–‡ä¸­ä»‹ç»äº†æµ‹è¯•ç±»å‹ï¼Œå¹¶ä¸¾äº†å¤§é‡ä¾‹å­ï¼‰ï¼š[å±•æœ› 2018 å¹´ JavaScript Testing](https://zhuanlan.zhihu.com/p/32702421)ï¼›
[ä½¿ç”¨Jestæµ‹è¯•JavaScript(Mockç¯‡)](https://zhuanlan.zhihu.com/p/47009664)ã€‚



